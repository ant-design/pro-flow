!(function(){var mc=Object.defineProperty,yc=Object.defineProperties;var wc=Object.getOwnPropertyDescriptors;var qs=Object.getOwnPropertySymbols;var _c=Object.prototype.hasOwnProperty,Sc=Object.prototype.propertyIsEnumerable;var ti=(C,A,w)=>A in C?mc(C,A,{enumerable:!0,configurable:!0,writable:!0,value:w}):C[A]=w,zn=(C,A)=>{for(var w in A||(A={}))_c.call(A,w)&&ti(C,w,A[w]);if(qs)for(var w of qs(A))Sc.call(A,w)&&ti(C,w,A[w]);return C},wr=(C,A)=>yc(C,wc(A));(self.webpackChunk_ant_design_pro_flow=self.webpackChunk_ant_design_pro_flow||[]).push([[4314],{517:function(C,A,w){"use strict";w.d(A,{Z:function(){return vt}});var E=w(33346),R=w(11582),S=w(47100),L=w(32618),v=w(77032),V=w(79960),O=w(54759),Z=w(45503),W,gt,pt,et=(0,Z.kc)(function(Rt,Y){var kt=Rt.token,X=Rt.css,Lt=Rt.cx,Et=Y.size,pe=Y.className,Zt=Y.prefixCls,Ht=typeof Et=="number"?X(W||(W=(0,O.Z)([`
          width: `,`px !important;
          height: `,`px !important;
        `])),Et,Et):"",Mt=X(gt||(gt=(0,O.Z)([`
    display: flex;
    align-items: center;
    justify-content: center;

    &:hover {
      color: `,` !important;
    }

    &:active {
      scale: 0.8;
      color: `,`;
    }

    transition: color 600ms `,", scale 400ms ",`,
      background-color 100ms `,`;
  `])),kt.colorText,kt.colorText,kt.motionEaseOut,kt.motionEaseOut,kt.motionEaseOut);return{container:Lt(Zt,Mt,Ht,pe),tooltip:X(pt||(pt=(0,O.Z)([`
      pointer-events: none;
    `])))}}),K=w(11527),ct=["placement","title","icon","cursor","onClick","className","arrow","size","tooltipDelay","prefixCls"],at=function(Y){var kt=Y.placement,X=Y.title,Lt=Y.icon,Et=Y.cursor,pe=Y.onClick,Zt=Y.className,Ht=Y.arrow,Mt=Ht===void 0?!1:Ht,ae=Y.size,_t=Y.tooltipDelay,Qt=_t===void 0?.5:_t,qt=Y.prefixCls,De=(0,R.Z)(Y,ct),me=(0,V.k2)("actionicon",qt),te=et({size:ae,prefixCls:me}),Ie=te.styles,ye=te.theme,Te=te.cx,Tt=(0,K.jsx)(S.ZP,(0,E.Z)((0,E.Z)({icon:Lt,className:Te(Ie.container,Zt),type:"text",style:{cursor:Et},size:"small"},De),{},{onClick:pe}));return(0,K.jsx)(v.iV,{componentToken:{Button:{colorText:ye.colorTextTertiary,colorBgTextHover:ye.colorFillSecondary,colorBgTextActive:ye.colorFill}},children:X?(0,K.jsx)(L.Z,{arrow:Mt,overlayClassName:Ie.tooltip,title:X,mouseEnterDelay:Qt,placement:kt,children:Tt}):Tt})},vt=at},77032:function(C,A,w){"use strict";w.d(A,{iV:function(){return gt}});var E=w(33346),R=w(30152),S=w(86007),L=w(43913),v=w(87362),V=function(K,ct){var at=v.Z.darkAlgorithm(K,ct);return(0,E.Z)((0,E.Z)({},at),{},{colorBgLayout:"#20252b",colorBgContainer:"#282c34",colorBgElevated:"#32363e"})},O=function(K){var ct={algorithm:[v.Z.compactAlgorithm]};return K==="dark"&&ct.algorithm.push(V),ct},Z=w(11527),W=function(K){var ct=(0,S.S)(),at=O(K),vt={colorBgContainer:ct==null?void 0:ct.colorFillQuaternary,colorBorder:"transparent",controlHeightSM:24,controlOutline:"transparent"};return at.components={Input:vt,InputNumber:vt,Select:vt,Tree:{colorBgContainer:"transparent",controlHeightSM:24},TreeSelect:vt},at},gt=function(K){var ct=K.children,at=K.componentToken,vt=(0,L.r)(),Rt=vt.appearance,Y=W(Rt);return at&&(Y.components=(0,E.Z)((0,E.Z)({},Y.components),at)),(0,Z.jsx)(R.ZP,{prefixCls:"studio",theme:Y,children:ct})},pt=function(K){return function(ct){return _jsx(gt,{children:_jsx(K,_objectSpread({},ct))})}}},79960:function(C,A,w){"use strict";w.d(A,{k2:function(){return R}});var E="studio";function R(S,L){return L||(S?"".concat(E,"-").concat(S):E)}},80111:function(C,A,w){"use strict";var E=w(50959),R=w(93915),S=w(85303);function L(v){S.Z&&((0,R.mf)(v)||console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof v)));var V=(0,E.useRef)(v);V.current=(0,E.useMemo)(function(){return v},[v]);var O=(0,E.useRef)();return O.current||(O.current=function(){for(var Z=[],W=0;W<arguments.length;W++)Z[W]=arguments[W];return V.current.apply(this,Z)}),O.current}A.Z=L},77347:function(C,A,w){"use strict";w.d(A,{Z:function(){return Ae}});var E=w(50959),R=w(84875),S=w.n(R),L=w(31594),v=w(94927),V=w(55904),Z=x=>{const{getPrefixCls:yt,direction:J}=(0,E.useContext)(L.E_),{prefixCls:j,className:nt}=x,Ct=yt("input-group",j),Vt=yt("input"),[dt,At]=(0,V.ZP)(Vt),Pt=S()(Ct,{[`${Ct}-lg`]:x.size==="large",[`${Ct}-sm`]:x.size==="small",[`${Ct}-compact`]:x.compact,[`${Ct}-rtl`]:J==="rtl"},At,nt),xt=(0,E.useContext)(v.aM),Ft=(0,E.useMemo)(()=>Object.assign(Object.assign({},xt),{isFormItemInput:!1}),[xt]);return dt(E.createElement("span",{className:Pt,style:x.style,onMouseEnter:x.onMouseEnter,onMouseLeave:x.onMouseLeave,onFocus:x.onFocus,onBlur:x.onBlur},E.createElement(v.aM.Provider,{value:Ft},x.children)))},W=w(21626),gt=w(38126),pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},et=pt,K=w(89011),ct=function(yt,J){return E.createElement(K.Z,(0,gt.Z)({},yt,{ref:J,icon:et}))},at=E.forwardRef(ct),vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},Rt=vt,Y=function(yt,J){return E.createElement(K.Z,(0,gt.Z)({},yt,{ref:J,icon:Rt}))},kt=E.forwardRef(Y),X=w(87017),Lt=w(12602),Et=w(59647),pe=function(x,yt){var J={};for(var j in x)Object.prototype.hasOwnProperty.call(x,j)&&yt.indexOf(j)<0&&(J[j]=x[j]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var nt=0,j=Object.getOwnPropertySymbols(x);nt<j.length;nt++)yt.indexOf(j[nt])<0&&Object.prototype.propertyIsEnumerable.call(x,j[nt])&&(J[j[nt]]=x[j[nt]]);return J};const Zt=x=>x?E.createElement(kt,null):E.createElement(at,null),Ht={click:"onClick",hover:"onMouseOver"};var ae=E.forwardRef((x,yt)=>{const{visibilityToggle:J=!0}=x,j=typeof J=="object"&&J.visible!==void 0,[nt,Ct]=(0,E.useState)(()=>j?J.visible:!1),Vt=(0,E.useRef)(null);E.useEffect(()=>{j&&Ct(J.visible)},[j,J]);const dt=(0,Et.Z)(Vt),At=()=>{const{disabled:Me}=x;Me||(nt&&dt(),Ct(Gt=>{var zt;const ue=!Gt;return typeof J=="object"&&((zt=J.onVisibleChange)===null||zt===void 0||zt.call(J,ue)),ue}))},Pt=Me=>{const{action:Gt="click",iconRender:zt=Zt}=x,ue=Ht[Gt]||"",l=zt(nt),d={[ue]:At,className:`${Me}-icon`,key:"passwordIcon",onMouseDown:p=>{p.preventDefault()},onMouseUp:p=>{p.preventDefault()}};return E.cloneElement(E.isValidElement(l)?l:E.createElement("span",null,l),d)},{className:xt,prefixCls:Ft,inputPrefixCls:ee,size:Ot}=x,xe=pe(x,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:wt}=E.useContext(L.E_),Oe=wt("input",ee),we=wt("input-password",Ft),Ue=J&&Pt(we),ne=S()(we,xt,{[`${we}-${Ot}`]:!!Ot}),Fe=Object.assign(Object.assign({},(0,X.Z)(xe,["suffix","iconRender","visibilityToggle"])),{type:nt?"text":"password",className:ne,prefixCls:Oe,suffix:Ue});return Ot&&(Fe.size=Ot),E.createElement(W.Z,Object.assign({ref:(0,Lt.sQ)(yt,Vt)},Fe))}),_t=w(9910),Qt=w(94914),qt=w(47100),De=w(17436),me=w(21130),te=function(x,yt){var J={};for(var j in x)Object.prototype.hasOwnProperty.call(x,j)&&yt.indexOf(j)<0&&(J[j]=x[j]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var nt=0,j=Object.getOwnPropertySymbols(x);nt<j.length;nt++)yt.indexOf(j[nt])<0&&Object.prototype.propertyIsEnumerable.call(x,j[nt])&&(J[j[nt]]=x[j[nt]]);return J},ye=E.forwardRef((x,yt)=>{const{prefixCls:J,inputPrefixCls:j,className:nt,size:Ct,suffix:Vt,enterButton:dt=!1,addonAfter:At,loading:Pt,disabled:xt,onSearch:Ft,onChange:ee,onCompositionStart:Ot,onCompositionEnd:xe}=x,wt=te(x,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:Oe,direction:we}=E.useContext(L.E_),Ue=E.useRef(!1),ne=Oe("input-search",J),Fe=Oe("input",j),{compactSize:Me}=(0,me.ri)(ne,we),Gt=(0,De.Z)(F=>{var T;return(T=Ct!=null?Ct:Me)!==null&&T!==void 0?T:F}),zt=E.useRef(null),ue=F=>{F&&F.target&&F.type==="click"&&Ft&&Ft(F.target.value,F,{source:"clear"}),ee&&ee(F)},l=F=>{var T;document.activeElement===((T=zt.current)===null||T===void 0?void 0:T.input)&&F.preventDefault()},d=F=>{var T,G;Ft&&Ft((G=(T=zt.current)===null||T===void 0?void 0:T.input)===null||G===void 0?void 0:G.value,F,{source:"input"})},p=F=>{Ue.current||Pt||d(F)},_=typeof dt=="boolean"?E.createElement(_t.Z,null):null,I=`${ne}-button`;let M;const U=dt||{},B=U.type&&U.type.__ANT_BUTTON===!0;B||U.type==="button"?M=(0,Qt.Tm)(U,Object.assign({onMouseDown:l,onClick:F=>{var T,G;(G=(T=U==null?void 0:U.props)===null||T===void 0?void 0:T.onClick)===null||G===void 0||G.call(T,F),d(F)},key:"enterButton"},B?{className:I,size:Gt}:{})):M=E.createElement(qt.ZP,{className:I,type:dt?"primary":void 0,size:Gt,disabled:xt,key:"enterButton",onMouseDown:l,onClick:d,loading:Pt,icon:_},dt),At&&(M=[M,(0,Qt.Tm)(At,{key:"addonAfter"})]);const b=S()(ne,{[`${ne}-rtl`]:we==="rtl",[`${ne}-${Gt}`]:!!Gt,[`${ne}-with-button`]:!!dt},nt),D=F=>{Ue.current=!0,Ot==null||Ot(F)},$=F=>{Ue.current=!1,xe==null||xe(F)};return E.createElement(W.Z,Object.assign({ref:(0,Lt.sQ)(zt,yt),onPressEnter:p},wt,{size:Gt,onCompositionStart:D,onCompositionEnd:$,prefixCls:Fe,addonAfter:M,suffix:Vt,onChange:ue,className:b,disabled:xt}))}),Te=w(61767);const Tt=W.Z;Tt.Group=Z,Tt.Search=ye,Tt.TextArea=Te.Z,Tt.Password=ae;var Ae=Tt},29130:function(C,A,w){"use strict";w.d(A,{N:function(){return S}});var E=w(73273),R=w(50959),S=function(v){return function(V,O){var Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[O],W=arguments.length>3?arguments[3]:void 0,gt=W!=null?W:v.setState;(0,R.useEffect)(function(){typeof O!="undefined"&&gt((0,E.Z)({},V,O),!1,{type:"\u{1F4AD} useStoreUpdater / ".concat(V),payload:O})},Z)}}},38980:function(C,A,w){"use strict";w.d(A,{v:function(){return R}});var E=w(50898),R=function(L){return L?E.mW:function(v){return v}}},90696:function(C){function A(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}C.exports=A,C.exports.__esModule=!0,C.exports.default=C.exports},38887:function(C,A,w){var E=w(61533);function R(S,L){var v=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!v){if(Array.isArray(S)||(v=E(S))||L&&S&&typeof S.length=="number"){v&&(S=v);var V=0,O=function(){};return{s:O,n:function(){return V>=S.length?{done:!0}:{done:!1,value:S[V++]}},e:function(et){throw et},f:O}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Z=!0,W=!1,gt;return{s:function(){v=v.call(S)},n:function(){var et=v.next();return Z=et.done,et},e:function(et){W=!0,gt=et},f:function(){try{!Z&&v.return!=null&&v.return()}finally{if(W)throw gt}}}}C.exports=R,C.exports.__esModule=!0,C.exports.default=C.exports},41206:function(C,A,w){var E=w(41607),R=w(14525),S=w(45543);function L(v){var V=R();return function(){var Z=E(v),W;if(V){var gt=E(this).constructor;W=Reflect.construct(Z,arguments,gt)}else W=Z.apply(this,arguments);return S(this,W)}}C.exports=L,C.exports.__esModule=!0,C.exports.default=C.exports},41607:function(C){function A(w){return C.exports=A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(R){return R.__proto__||Object.getPrototypeOf(R)},C.exports.__esModule=!0,C.exports.default=C.exports,A(w)}C.exports=A,C.exports.__esModule=!0,C.exports.default=C.exports},13762:function(C,A,w){var E=w(78382);function R(S,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(L&&L.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),Object.defineProperty(S,"prototype",{writable:!1}),L&&E(S,L)}C.exports=R,C.exports.__esModule=!0,C.exports.default=C.exports},14525:function(C){function A(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(w){return!1}}C.exports=A,C.exports.__esModule=!0,C.exports.default=C.exports},95530:function(C,A,w){var E=w(70285);function R(S,L){if(S==null)return{};var v=E(S,L),V,O;if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(S);for(O=0;O<Z.length;O++)V=Z[O],!(L.indexOf(V)>=0)&&Object.prototype.propertyIsEnumerable.call(S,V)&&(v[V]=S[V])}return v}C.exports=R,C.exports.__esModule=!0,C.exports.default=C.exports},70285:function(C){function A(w,E){if(w==null)return{};var R={},S=Object.keys(w),L,v;for(v=0;v<S.length;v++)L=S[v],!(E.indexOf(L)>=0)&&(R[L]=w[L]);return R}C.exports=A,C.exports.__esModule=!0,C.exports.default=C.exports},45543:function(C,A,w){var E=w(27566).default,R=w(90696);function S(L,v){if(v&&(E(v)==="object"||typeof v=="function"))return v;if(v!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R(L)}C.exports=S,C.exports.__esModule=!0,C.exports.default=C.exports},78382:function(C){function A(w,E){return C.exports=A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(S,L){return S.__proto__=L,S},C.exports.__esModule=!0,C.exports.default=C.exports,A(w,E)}C.exports=A,C.exports.__esModule=!0,C.exports.default=C.exports},64461:function(C,A,w){"use strict";w.d(A,{Uy:function(){return Oe}});var E=Symbol.for("immer-nothing"),R=Symbol.for("immer-draftable"),S=Symbol.for("immer-state"),L=[];function v(l,...d){throw new Error(`[Immer] minified error nr: ${l}. Full error at: https://bit.ly/3cXEKWf`)}var V=Object.getPrototypeOf;function O(l){return!!l&&!!l[S]}function Z(l){var d;return l?gt(l)||Array.isArray(l)||!!l[R]||!!((d=l.constructor)!=null&&d[R])||Y(l)||kt(l):!1}var W=Object.prototype.constructor.toString();function gt(l){if(!l||typeof l!="object")return!1;const d=V(l);if(d===null)return!0;const p=Object.hasOwnProperty.call(d,"constructor")&&d.constructor;return p===Object?!0:typeof p=="function"&&Function.toString.call(p)===W}function pt(l){return O(l)||v(15,l),l[S].base_}function et(l,d){K(l)===0?Object.entries(l).forEach(([p,_])=>{d(p,_,l)}):l.forEach((p,_)=>d(_,p,l))}function K(l){const d=l[S];return d?d.type_:Array.isArray(l)?1:Y(l)?2:kt(l)?3:0}function ct(l,d){return K(l)===2?l.has(d):Object.prototype.hasOwnProperty.call(l,d)}function at(l,d){return K(l)===2?l.get(d):l[d]}function vt(l,d,p){const _=K(l);_===2?l.set(d,p):_===3?l.add(p):l[d]=p}function Rt(l,d){return l===d?l!==0||1/l===1/d:l!==l&&d!==d}function Y(l){return l instanceof Map}function kt(l){return l instanceof Set}function X(l){return l.copy_||l.base_}function Lt(l,d){if(Y(l))return new Map(l);if(kt(l))return new Set(l);if(Array.isArray(l))return Array.prototype.slice.call(l);if(!d&&gt(l))return V(l)?zn({},l):Object.assign(Object.create(null),l);const p=Object.getOwnPropertyDescriptors(l);delete p[S];let _=Reflect.ownKeys(p);for(let I=0;I<_.length;I++){const M=_[I],U=p[M];U.writable===!1&&(U.writable=!0,U.configurable=!0),(U.get||U.set)&&(p[M]={configurable:!0,writable:!0,enumerable:U.enumerable,value:l[M]})}return Object.create(V(l),p)}function Et(l,d=!1){return Zt(l)||O(l)||!Z(l)||(K(l)>1&&(l.set=l.add=l.clear=l.delete=pe),Object.freeze(l),d&&et(l,(p,_)=>Et(_,!0),!0)),l}function pe(){v(2)}function Zt(l){return Object.isFrozen(l)}var Ht={};function Mt(l){const d=Ht[l];return d||v(0,l),d}function ae(l,d){Ht[l]||(Ht[l]=d)}var _t;function Qt(){return _t}function qt(l,d){return{drafts_:[],parent_:l,immer_:d,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function De(l,d){d&&(Mt("Patches"),l.patches_=[],l.inversePatches_=[],l.patchListener_=d)}function me(l){te(l),l.drafts_.forEach(ye),l.drafts_=null}function te(l){l===_t&&(_t=l.parent_)}function Ie(l){return _t=qt(_t,l)}function ye(l){const d=l[S];d.type_===0||d.type_===1?d.revoke_():d.revoked_=!0}function Te(l,d){d.unfinalizedDrafts_=d.drafts_.length;const p=d.drafts_[0];return l!==void 0&&l!==p?(p[S].modified_&&(me(d),v(4)),Z(l)&&(l=Tt(d,l),d.parent_||x(d,l)),d.patches_&&Mt("Patches").generateReplacementPatches_(p[S].base_,l,d.patches_,d.inversePatches_)):l=Tt(d,p,[]),me(d),d.patches_&&d.patchListener_(d.patches_,d.inversePatches_),l!==E?l:void 0}function Tt(l,d,p){if(Zt(d))return d;const _=d[S];if(!_)return et(d,(I,M)=>Ae(l,_,d,I,M,p),!0),d;if(_.scope_!==l)return d;if(!_.modified_)return x(l,_.base_,!0),_.base_;if(!_.finalized_){_.finalized_=!0,_.scope_.unfinalizedDrafts_--;const I=_.copy_;let M=I,U=!1;_.type_===3&&(M=new Set(I),I.clear(),U=!0),et(M,(B,b)=>Ae(l,_,I,B,b,p,U)),x(l,I,!1),p&&l.patches_&&Mt("Patches").generatePatches_(_,p,l.patches_,l.inversePatches_)}return _.copy_}function Ae(l,d,p,_,I,M,U){if(O(I)){const B=M&&d&&d.type_!==3&&!ct(d.assigned_,_)?M.concat(_):void 0,b=Tt(l,I,B);if(vt(p,_,b),O(b))l.canAutoFreeze_=!1;else return}else U&&p.add(I);if(Z(I)&&!Zt(I)){if(!l.immer_.autoFreeze_&&l.unfinalizedDrafts_<1)return;Tt(l,I),(!d||!d.scope_.parent_)&&x(l,I)}}function x(l,d,p=!1){!l.parent_&&l.immer_.autoFreeze_&&l.canAutoFreeze_&&Et(d,p)}function yt(l,d){const p=Array.isArray(l),_={type_:p?1:0,scope_:d?d.scope_:Qt(),modified_:!1,finalized_:!1,assigned_:{},parent_:d,base_:l,draft_:null,copy_:null,revoke_:null,isManual_:!1};let I=_,M=J;p&&(I=[_],M=j);const{revoke:U,proxy:B}=Proxy.revocable(I,M);return _.draft_=B,_.revoke_=U,B}var J={get(l,d){if(d===S)return l;const p=X(l);if(!ct(p,d))return Ct(l,p,d);const _=p[d];return l.finalized_||!Z(_)?_:_===nt(l.base_,d)?(At(l),l.copy_[d]=xt(_,l)):_},has(l,d){return d in X(l)},ownKeys(l){return Reflect.ownKeys(X(l))},set(l,d,p){const _=Vt(X(l),d);if(_!=null&&_.set)return _.set.call(l.draft_,p),!0;if(!l.modified_){const I=nt(X(l),d),M=I==null?void 0:I[S];if(M&&M.base_===p)return l.copy_[d]=p,l.assigned_[d]=!1,!0;if(Rt(p,I)&&(p!==void 0||ct(l.base_,d)))return!0;At(l),dt(l)}return l.copy_[d]===p&&(p!==void 0||d in l.copy_)||Number.isNaN(p)&&Number.isNaN(l.copy_[d])||(l.copy_[d]=p,l.assigned_[d]=!0),!0},deleteProperty(l,d){return nt(l.base_,d)!==void 0||d in l.base_?(l.assigned_[d]=!1,At(l),dt(l)):delete l.assigned_[d],l.copy_&&delete l.copy_[d],!0},getOwnPropertyDescriptor(l,d){const p=X(l),_=Reflect.getOwnPropertyDescriptor(p,d);return _&&{writable:!0,configurable:l.type_!==1||d!=="length",enumerable:_.enumerable,value:p[d]}},defineProperty(){v(11)},getPrototypeOf(l){return V(l.base_)},setPrototypeOf(){v(12)}},j={};et(J,(l,d)=>{j[l]=function(){return arguments[0]=arguments[0][0],d.apply(this,arguments)}}),j.deleteProperty=function(l,d){return j.set.call(this,l,d,void 0)},j.set=function(l,d,p){return J.set.call(this,l[0],d,p,l[0])};function nt(l,d){const p=l[S];return(p?X(p):l)[d]}function Ct(l,d,p){var I;const _=Vt(d,p);return _?"value"in _?_.value:(I=_.get)==null?void 0:I.call(l.draft_):void 0}function Vt(l,d){if(!(d in l))return;let p=V(l);for(;p;){const _=Object.getOwnPropertyDescriptor(p,d);if(_)return _;p=V(p)}}function dt(l){l.modified_||(l.modified_=!0,l.parent_&&dt(l.parent_))}function At(l){l.copy_||(l.copy_=Lt(l.base_,l.scope_.immer_.useStrictShallowCopy_))}var Pt=class{constructor(l){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(d,p,_)=>{if(typeof d=="function"&&typeof p!="function"){const M=p;p=d;const U=this;return function(b=M,...D){return U.produce(b,$=>p.call(this,$,...D))}}typeof p!="function"&&v(6),_!==void 0&&typeof _!="function"&&v(7);let I;if(Z(d)){const M=Ie(this),U=xt(d,void 0);let B=!0;try{I=p(U),B=!1}finally{B?me(M):te(M)}return De(M,_),Te(I,M)}else if(!d||typeof d!="object"){if(I=p(d),I===void 0&&(I=d),I===E&&(I=void 0),this.autoFreeze_&&Et(I,!0),_){const M=[],U=[];Mt("Patches").generateReplacementPatches_(d,I,M,U),_(M,U)}return I}else v(1,d)},this.produceWithPatches=(d,p)=>{if(typeof d=="function")return(U,...B)=>this.produceWithPatches(U,b=>d(b,...B));let _,I;return[this.produce(d,p,(U,B)=>{_=U,I=B}),_,I]},typeof(l==null?void 0:l.autoFreeze)=="boolean"&&this.setAutoFreeze(l.autoFreeze),typeof(l==null?void 0:l.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(l.useStrictShallowCopy)}createDraft(l){Z(l)||v(8),O(l)&&(l=Ft(l));const d=Ie(this),p=xt(l,void 0);return p[S].isManual_=!0,te(d),p}finishDraft(l,d){const p=l&&l[S];(!p||!p.isManual_)&&v(9);const{scope_:_}=p;return De(_,d),Te(void 0,_)}setAutoFreeze(l){this.autoFreeze_=l}setUseStrictShallowCopy(l){this.useStrictShallowCopy_=l}applyPatches(l,d){let p;for(p=d.length-1;p>=0;p--){const I=d[p];if(I.path.length===0&&I.op==="replace"){l=I.value;break}}p>-1&&(d=d.slice(p+1));const _=Mt("Patches").applyPatches_;return O(l)?_(l,d):this.produce(l,I=>_(I,d))}};function xt(l,d){const p=Y(l)?Mt("MapSet").proxyMap_(l,d):kt(l)?Mt("MapSet").proxySet_(l,d):yt(l,d);return(d?d.scope_:Qt()).drafts_.push(p),p}function Ft(l){return O(l)||v(10,l),ee(l)}function ee(l){if(!Z(l)||Zt(l))return l;const d=l[S];let p;if(d){if(!d.modified_)return d.base_;d.finalized_=!0,p=Lt(l,d.scope_.immer_.useStrictShallowCopy_)}else p=Lt(l,!0);return et(p,(_,I)=>{vt(p,_,ee(I))}),d&&(d.finalized_=!1),p}function Ot(){const d="replace",p="add",_="remove";function I(T,G,rt,lt){switch(T.type_){case 0:case 2:return U(T,G,rt,lt);case 1:return M(T,G,rt,lt);case 3:return B(T,G,rt,lt)}}function M(T,G,rt,lt){let{base_:St,assigned_:st}=T,it=T.copy_;it.length<St.length&&([St,it]=[it,St],[rt,lt]=[lt,rt]);for(let z=0;z<St.length;z++)if(st[z]&&it[z]!==St[z]){const H=G.concat([z]);rt.push({op:d,path:H,value:F(it[z])}),lt.push({op:d,path:H,value:F(St[z])})}for(let z=St.length;z<it.length;z++){const H=G.concat([z]);rt.push({op:p,path:H,value:F(it[z])})}for(let z=it.length-1;St.length<=z;--z){const H=G.concat([z]);lt.push({op:_,path:H})}}function U(T,G,rt,lt){const{base_:St,copy_:st}=T;et(T.assigned_,(it,z)=>{const H=at(St,it),Ne=at(st,it),re=z?ct(St,it)?d:p:_;if(H===Ne&&re===d)return;const Dt=G.concat(it);rt.push(re===_?{op:re,path:Dt}:{op:re,path:Dt,value:Ne}),lt.push(re===p?{op:_,path:Dt}:re===_?{op:p,path:Dt,value:F(H)}:{op:d,path:Dt,value:F(H)})})}function B(T,G,rt,lt){let{base_:St,copy_:st}=T,it=0;St.forEach(z=>{if(!st.has(z)){const H=G.concat([it]);rt.push({op:_,path:H,value:z}),lt.unshift({op:p,path:H,value:z})}it++}),it=0,st.forEach(z=>{if(!St.has(z)){const H=G.concat([it]);rt.push({op:p,path:H,value:z}),lt.unshift({op:_,path:H,value:z})}it++})}function b(T,G,rt,lt){rt.push({op:d,path:[],value:G===E?void 0:G}),lt.push({op:d,path:[],value:T})}function D(T,G){return G.forEach(rt=>{const{path:lt,op:St}=rt;let st=T;for(let Ne=0;Ne<lt.length-1;Ne++){const re=K(st);let Dt=lt[Ne];typeof Dt!="string"&&typeof Dt!="number"&&(Dt=""+Dt),(re===0||re===1)&&(Dt==="__proto__"||Dt==="constructor")&&v(16+3),typeof st=="function"&&Dt==="prototype"&&v(16+3),st=at(st,Dt),typeof st!="object"&&v(16+2,lt.join("/"))}const it=K(st),z=$(rt.value),H=lt[lt.length-1];switch(St){case d:switch(it){case 2:return st.set(H,z);case 3:v(16);default:return st[H]=z}case p:switch(it){case 1:return H==="-"?st.push(z):st.splice(H,0,z);case 2:return st.set(H,z);case 3:return st.add(z);default:return st[H]=z}case _:switch(it){case 1:return st.splice(H,1);case 2:return st.delete(H);case 3:return st.delete(rt.value);default:return delete st[H]}default:v(16+1,St)}}),T}function $(T){if(!Z(T))return T;if(Array.isArray(T))return T.map($);if(Y(T))return new Map(Array.from(T.entries()).map(([rt,lt])=>[rt,$(lt)]));if(kt(T))return new Set(Array.from(T).map($));const G=Object.create(V(T));for(const rt in T)G[rt]=$(T[rt]);return ct(T,R)&&(G[R]=T[R]),G}function F(T){return O(T)?$(T):T}ae("Patches",{applyPatches_:D,generatePatches_:I,generateReplacementPatches_:b})}function xe(){class l extends Map{constructor(b,D){super(),this[S]={type_:2,parent_:D,scope_:D?D.scope_:Qt(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:b,draft_:this,isManual_:!1,revoked_:!1}}get size(){return X(this[S]).size}has(b){return X(this[S]).has(b)}set(b,D){const $=this[S];return U($),(!X($).has(b)||X($).get(b)!==D)&&(p($),dt($),$.assigned_.set(b,!0),$.copy_.set(b,D),$.assigned_.set(b,!0)),this}delete(b){if(!this.has(b))return!1;const D=this[S];return U(D),p(D),dt(D),D.base_.has(b)?D.assigned_.set(b,!1):D.assigned_.delete(b),D.copy_.delete(b),!0}clear(){const b=this[S];U(b),X(b).size&&(p(b),dt(b),b.assigned_=new Map,et(b.base_,D=>{b.assigned_.set(D,!1)}),b.copy_.clear())}forEach(b,D){const $=this[S];X($).forEach((F,T,G)=>{b.call(D,this.get(T),T,this)})}get(b){const D=this[S];U(D);const $=X(D).get(b);if(D.finalized_||!Z($)||$!==D.base_.get(b))return $;const F=xt($,D);return p(D),D.copy_.set(b,F),F}keys(){return X(this[S]).keys()}values(){const b=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const D=b.next();return D.done?D:{done:!1,value:this.get(D.value)}}}}entries(){const b=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const D=b.next();if(D.done)return D;const $=this.get(D.value);return{done:!1,value:[D.value,$]}}}}[Symbol.iterator](){return this.entries()}}function d(B,b){return new l(B,b)}function p(B){B.copy_||(B.assigned_=new Map,B.copy_=new Map(B.base_))}class _ extends Set{constructor(b,D){super(),this[S]={type_:3,parent_:D,scope_:D?D.scope_:Qt(),modified_:!1,finalized_:!1,copy_:void 0,base_:b,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return X(this[S]).size}has(b){const D=this[S];return U(D),D.copy_?!!(D.copy_.has(b)||D.drafts_.has(b)&&D.copy_.has(D.drafts_.get(b))):D.base_.has(b)}add(b){const D=this[S];return U(D),this.has(b)||(M(D),dt(D),D.copy_.add(b)),this}delete(b){if(!this.has(b))return!1;const D=this[S];return U(D),M(D),dt(D),D.copy_.delete(b)||(D.drafts_.has(b)?D.copy_.delete(D.drafts_.get(b)):!1)}clear(){const b=this[S];U(b),X(b).size&&(M(b),dt(b),b.copy_.clear())}values(){const b=this[S];return U(b),M(b),b.copy_.values()}entries(){const b=this[S];return U(b),M(b),b.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(b,D){const $=this.values();let F=$.next();for(;!F.done;)b.call(D,F.value,F.value,this),F=$.next()}}function I(B,b){return new _(B,b)}function M(B){B.copy_||(B.copy_=new Set,B.base_.forEach(b=>{if(Z(b)){const D=xt(b,B);B.drafts_.set(b,D),B.copy_.add(D)}else B.copy_.add(b)}))}function U(B){B.revoked_&&v(3,JSON.stringify(X(B)))}ae("MapSet",{proxyMap_:d,proxySet_:I})}var wt=new Pt,Oe=wt.produce,we=wt.produceWithPatches.bind(wt),Ue=wt.setAutoFreeze.bind(wt),ne=wt.setUseStrictShallowCopy.bind(wt),Fe=wt.applyPatches.bind(wt),Me=wt.createDraft.bind(wt),Gt=wt.finishDraft.bind(wt);function zt(l){return l}function ue(l){return l}},67197:function(C,A,w){"use strict";w.d(A,{kP:function(){return S}});let E=v=>crypto.getRandomValues(new Uint8Array(v)),R=(v,V,O)=>{let Z=(2<<Math.log(v.length-1)/Math.LN2)-1,W=-~(1.6*Z*V/v.length);return(gt=V)=>{let pt="";for(;;){let et=O(W),K=W;for(;K--;)if(pt+=v[et[K]&Z]||"",pt.length===gt)return pt}}},S=(v,V=21)=>R(v,V,E),L=(v=21)=>crypto.getRandomValues(new Uint8Array(v)).reduce((V,O)=>(O&=63,O<36?V+=O.toString(36):O<62?V+=(O-26).toString(36).toUpperCase():O>62?V+="-":V+="_",V),"")},15836:function(C,A,w){"use strict";w.d(A,{QW:function(){return Re},H6:function(){return So}});const E=()=>new Map,R=e=>{const t=E();return e.forEach((n,r)=>{t.set(r,n)}),t},S=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},L=(e,t)=>{const n=[];for(const[r,s]of e)n.push(t(s,r));return n},v=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},V=(e,t)=>{for(const[n,r]of e)if(!t(r,n))return!1;return!0},O=()=>new Set,Z=e=>Array.from(e),W=e=>e.values().next().value||void 0,gt=e=>new Set(e),pt=e=>e[e.length-1],et=()=>[],K=e=>e.slice(),ct=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},at=Array.from,vt=(e,t)=>{for(let n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0},Rt=(e,t)=>{for(let n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1},Y=(e,t)=>e.length===t.length&&vt(e,(n,r)=>n===t[r]),kt=e=>Lt(e,[],(t,n)=>t.concat(n)),X=(e,t)=>{const n=new Array(e);for(let r=0;r<e;r++)n[r]=t(r,n);return n},Lt=(e,t,n)=>e.reduce(n,t),Et=Array.isArray,pe=e=>at(set.from(e)),Zt=(e,t)=>{const n=set.create(),r=[];for(let s=0;s<e.length;s++){const i=e[s],o=t(i);n.has(o)||(n.add(o),r.push(i))}return r},Ht=(e,t)=>{const n=Array(e.length);for(let r=0;r<e.length;r++)n[r]=t(e[r],r,e);return n};class Mt{constructor(){this._observers=map.create()}on(t,n){return map.setIfUndefined(this._observers,t,set.create).add(n),n}once(t,n){const r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return array.from((this._observers.get(t)||map.create()).values()).forEach(r=>r(...n))}destroy(){this._observers=map.create()}}class ae{constructor(){this._observers=E()}on(t,n){S(this._observers,t,O).add(n)}once(t,n){const r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return at((this._observers.get(t)||E()).values()).forEach(r=>r(...n))}destroy(){this._observers=E()}}const _t=Math.floor,Qt=Math.ceil,qt=Math.abs,De=Math.imul,me=Math.round,te=Math.log10,Ie=Math.log2,ye=Math.log,Te=Math.sqrt,Tt=(e,t)=>e+t,Ae=(e,t)=>e<t?e:t,x=(e,t)=>e>t?e:t,yt=Number.isNaN,J=Math.pow,j=e=>Math.pow(10,e),nt=Math.sign,Ct=e=>e!==0?e<0:1/e<0,Vt=1,dt=2,At=4,Pt=8,xt=16,Ft=32,ee=64,Ot=128,xe=256,wt=512,Oe=1024,we=2048,Ue=4096,ne=8192,Fe=16384,Me=32768,Gt=65536,zt=1<<17,ue=1<<18,l=1<<19,d=1<<20,p=1<<21,_=1<<22,I=1<<23,M=1<<24,U=1<<25,B=1<<26,b=1<<27,D=1<<28,$=1<<29,F=1<<30,T=null,G=0,rt=1,lt=3,St=7,st=15,it=31,z=63,H=127,Ne=255,re=511,Dt=1023,bc=2047,kc=4095,Ec=8191,Cc=16383,vc=32767,Dc=65535,Ic=zt-1,Tc=ue-1,Ac=l-1,xc=d-1,Oc=p-1,Uc=_-1,Mc=I-1,Nc=M-1,Bc=U-1,Rc=B-1,Lc=b-1,Vc=D-1,Pc=$-1,Fc=F-1,_r=2147483647,ei=4294967295,zc=Number.MAX_SAFE_INTEGER,jc=Number.MIN_SAFE_INTEGER,$c=null,Zc=_r,Hc=ei,ni=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&_t(e)===e),Gc=Number.isNaN,Wc=Number.parseInt,Jc=e=>{e&=binary.BITS32;let t=0;for(;e;)e&=e-1,t++;return t},ri=String.fromCharCode,Kc=String.fromCodePoint,Yc=ri(65535),si=e=>e.toLowerCase(),ii=/^\s*/g,oi=e=>e.replace(ii,""),ci=/([A-Z])/g,Sr=(e,t)=>oi(e.replace(ci,n=>`${t}${si(n)}`)),Xc=e=>unescape(encodeURIComponent(e)).length,li=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r},sn=typeof TextEncoder!="undefined"?new TextEncoder:null,ai=sn?e=>sn.encode(e):li,qc=e=>{let t=e.length,n="",r=0;for(;t>0;){const s=t<1e4?t:1e4,i=e.subarray(r,r+s);r+=s,n+=String.fromCodePoint.apply(null,i),t-=s}return decodeURIComponent(escape(n))};let gn=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});gn&&gn.decode(new Uint8Array).length===1&&(gn=null);const tl=e=>gn.decode(e),el=null,nl=(e,t,n,r="")=>e.slice(0,t)+r+e.slice(t+n),rl=(e,t)=>array.unfold(t,()=>e).join("");class ze{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const pn=()=>new ze,sl=e=>{const t=pn();return e(t),jt(t)},ui=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},il=e=>e.cpos>0||e.bufs.length>0,jt=e=>{const t=new Uint8Array(ui(e));let n=0;for(let r=0;r<e.bufs.length;r++){const s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},di=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(x(n,t)*2),e.cpos=0)},ot=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},jn=(e,t,n)=>{let r=null;for(let s=0;s<e.bufs.length&&r===null;s++){const i=e.bufs[s];t<i.length?r=i:t-=i.length}r===null&&(r=e.cbuf),r[t]=n},$n=ot,ol=null,cl=(e,t)=>{ot(e,t&binary.BITS8),ot(e,t>>>8&binary.BITS8)},ll=(e,t,n)=>{jn(e,t,n&binary.BITS8),jn(e,t+1,n>>>8&binary.BITS8)},al=(e,t)=>{for(let n=0;n<4;n++)ot(e,t&binary.BITS8),t>>>=8},ul=(e,t)=>{for(let n=3;n>=0;n--)ot(e,t>>>8*n&binary.BITS8)},dl=(e,t,n)=>{for(let r=0;r<4;r++)jn(e,t+r,n&binary.BITS8),n>>>=8},Q=(e,t)=>{for(;t>H;)ot(e,Ot|H&t),t=_t(t/128);ot(e,H&t)},on=(e,t)=>{const n=Ct(t);for(n&&(t=-t),ot(e,(t>z?Ot:0)|(n?ee:0)|z&t),t=_t(t/64);t>0;)ot(e,(t>H?Ot:0)|H&t),t=_t(t/128)},Zn=new Uint8Array(3e4),hi=Zn.length/3,fi=(e,t)=>{if(t.length<hi){const n=sn.encodeInto(t,Zn).written||0;Q(e,n);for(let r=0;r<n;r++)ot(e,Zn[r])}else Nt(e,ai(t))},gi=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;Q(e,r);for(let s=0;s<r;s++)ot(e,n.codePointAt(s))},je=sn&&sn.encodeInto?fi:gi,hl=(e,t)=>pi(e,string.encodeUtf8(t)),pi=(e,t)=>{for(let n=0;n<t.length;n++){const r=t[n];(r===0||r===1)&&ot(e,1),ot(e,t[n])}ot(e,0)},fl=(e,t)=>mn(e,jt(t)),mn=(e,t)=>{const n=e.cbuf.length,r=e.cpos,s=Ae(n-r,t.length),i=t.length-s;e.cbuf.set(t.subarray(0,s),r),e.cpos+=s,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(x(n*2,i)),e.cbuf.set(t.subarray(s)),e.cpos=i)},Nt=(e,t)=>{Q(e,t.byteLength),mn(e,t)},yn=(e,t)=>{di(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},mi=(e,t)=>yn(e,4).setFloat32(0,t,!1),yi=(e,t)=>yn(e,8).setFloat64(0,t,!1),wi=(e,t)=>yn(e,8).setBigInt64(0,t,!1),gl=(e,t)=>yn(e,8).setBigUint64(0,t,!1),br=new DataView(new ArrayBuffer(4)),_i=e=>(br.setFloat32(0,e),br.getFloat32(0)===e),cn=(e,t)=>{switch(typeof t){case"string":ot(e,119),je(e,t);break;case"number":ni(t)&&qt(t)<=_r?(ot(e,125),on(e,t)):_i(t)?(ot(e,124),mi(e,t)):(ot(e,123),yi(e,t));break;case"bigint":ot(e,122),wi(e,t);break;case"object":if(t===null)ot(e,126);else if(Et(t)){ot(e,117),Q(e,t.length);for(let n=0;n<t.length;n++)cn(e,t[n])}else if(t instanceof Uint8Array)ot(e,116),Nt(e,t);else{ot(e,118);const n=Object.keys(t);Q(e,n.length);for(let r=0;r<n.length;r++){const s=n[r];je(e,s),cn(e,t[s])}}break;case"boolean":ot(e,t?120:121);break;default:ot(e,127)}};class kr extends ze{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&Q(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}class pl extends null{constructor(t){super(),this.s=t}write(t){on(this,t-this.s),this.s=t}}class ml extends null{constructor(t){super(),this.s=t,this.count=0}write(t){this.s===t&&this.count>0?this.count++:(this.count>0&&Q(this,this.count-1),this.count=1,on(this,t-this.s),this.s=t)}}const wn=e=>{e.count>0&&(on(e.encoder,e.count===1?e.s:-e.s),e.count>1&&Q(e.encoder,e.count-2))};class _n{constructor(){this.encoder=new ze,this.s=0,this.count=0}write(t){this.s===t?this.count++:(wn(this),this.count=1,this.s=t)}toUint8Array(){return wn(this),jt(this.encoder)}}class yl{constructor(){this.encoder=new ze,this.s=0,this.count=0}write(t){this.s+this.count===t?this.count++:(wn(this),this.count=1,this.s=t)}toUint8Array(){return wn(this),jt(this.encoder)}}const Er=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);on(e.encoder,t),e.count>1&&Q(e.encoder,e.count-2)}};class Hn{constructor(){this.encoder=new ze,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Er(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Er(this),jt(this.encoder)}}class Si{constructor(){this.sarr=[],this.s="",this.lensE=new _n}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new ze;return this.sarr.push(this.s),this.s="",je(t,this.sarr.join("")),mn(t,this.lensE.toUint8Array()),jt(t)}}const wl=crypto.subtle,bi=crypto.getRandomValues.bind(crypto),ki=Math.random,Cr=()=>bi(new Uint32Array(1))[0],_l=()=>{const e=getRandomValues(new Uint32Array(8));return(e[0]&binary.BITS21)*(binary.BITS32+1)+(e[1]>>>0)},Sl=e=>e[math.floor(ki()*e.length)],Ei=[1e7]+-1e3+-4e3+-8e3+-1e11,Ci=()=>Ei.replace(/[018]/g,e=>(e^Cr()&15>>e/4).toString(16)),Sn=e=>new Promise(e),bl=e=>new Promise(e),kl=Promise.all.bind(Promise),El=e=>Promise.reject(e),Cl=e=>Promise.resolve(e),vl=e=>Promise.resolve(e),Dl=(e,t,n=10)=>Sn((r,s)=>{const i=time.getUnixTime(),o=e>0,a=setInterval(()=>{t()?(clearInterval(a),r()):o&&time.getUnixTime()-i>e&&(clearInterval(a),s(new Error("Timeout")))},n)}),Il=e=>Sn((t,n)=>setTimeout(t,e)),Tl=e=>e instanceof Promise||e&&e.then&&e.catch&&e.finally,$e=e=>new Error(e),se=()=>{throw $e("Method unimplemented")},de=()=>{throw $e("Unexpected case")},Gn=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&Gn(e,t,n+1)}},Al=()=>{},xl=e=>e(),Ol=e=>e,vi=(e,t)=>e===t,Ul=(e,t)=>e===t||e!=null&&t!=null&&e.constructor===t.constructor&&(array.isArray(e)&&array.equalFlat(e,t)||typeof e=="object"&&object.equalFlat(e,t)),Wn=(e,t)=>{if(e==null||t==null)return vi(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!Wn(e.get(n),t.get(n)))return!1;break}case Object:if(object.length(e)!==object.length(t))return!1;for(const n in e)if(!object.hasProperty(e,n)||!Wn(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Wn(e[n],t[n]))return!1;break;default:return!1}return!0},Di=(e,t)=>t.includes(e),Ml=Et,Nl=e=>e&&e.constructor===String,Bl=e=>e!=null&&e.constructor===Number,Rl=(e,t)=>e&&e.constructor===t,Ll=e=>t=>t&&t.constructor===e,vr=e=>e===void 0?null:e;class Ii{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let Dr=new Ii,Jn=!0;try{typeof localStorage!="undefined"&&localStorage&&(Dr=localStorage,Jn=!1)}catch(e){}const Ti=Dr,Vl=e=>Jn||addEventListener("storage",e),Pl=e=>Jn||removeEventListener("storage",e);var Be=w(14224);const Ze=typeof Be!="undefined"&&Be.release&&/node|io\.js/.test(Be.release.name)&&Object.prototype.toString.call(typeof Be!="undefined"?Be:0)==="[object process]",Fl=typeof window!="undefined"&&typeof document!="undefined"&&!Ze,zl=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;let ie;const Ai=[],Kn=()=>{if(ie===void 0)if(Ze){ie=E();const e=Be.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&ie.set(t,""),t=r):t!==null?(ie.set(t,r),t=null):Ai.push(r)}t!==null&&ie.set(t,"")}else typeof location=="object"?(ie=E(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");ie.set(`--${Sr(t,"-")}`,n),ie.set(`-${Sr(t,"-")}`,n)}})):ie=E();return ie},Yn=e=>Kn().has(e),jl=(e,t)=>Kn().get(e)||t,bn=e=>vr(Ze?{NODE_ENV:"production",PUBLIC_PATH:"/pro-flow/"}[e.toUpperCase()]:Ti.getItem(e)),$l=e=>Kn().get("--"+e)||bn(e),Hl=(e=>Yn("--"+e)||bn(e)!==null)("production"),Ir=Ze&&Di({NODE_ENV:"production",PUBLIC_PATH:"/pro-flow/"}.FORCE_COLOR,["true","1","2"]),xi=!Yn("no-colors")&&(!Ze||Be.stdout.isTTY||Ir)&&(!Ze||Yn("color")||Ir||bn("COLORTERM")!==null||(bn("TERM")||"").includes("color"));class Tr{constructor(t,n){this.left=t,this.right=n}}const he=(e,t)=>new Tr(e,t),Gl=(e,t)=>new Tr(t,e),Wl=(e,t)=>e.forEach(n=>t(n.left,n.right)),Jl=(e,t)=>e.map(n=>t(n.left,n.right)),Wt=typeof document!="undefined"?document:{},Ar=e=>Wt.createElement(e),Oi=()=>Wt.createDocumentFragment(),Kl=e=>Wt.createTextNode(e),Ui=typeof DOMParser!="undefined"?new DOMParser:null,Yl=(e,t,n)=>e.dispatchEvent(new CustomEvent(t,n)),Mi=(e,t)=>(pair.forEach(t,(n,r)=>{r===!1?e.removeAttribute(n):r===!0?e.setAttribute(n,""):e.setAttribute(n,r)}),e),Xl=(e,t)=>(t.forEach((n,r)=>{e.setAttribute(r,n)}),e),xr=e=>{const t=Oi();for(let n=0;n<e.length;n++)Ur(t,e[n]);return t},Ni=(e,t)=>(Ur(e,xr(t)),e),Ql=e=>e.remove(),Bi=(e,t,n)=>e.addEventListener(t,n),Ri=(e,t,n)=>e.removeEventListener(t,n),ql=(e,t)=>(pair.forEach(t,(n,r)=>Bi(e,n,r)),e),ta=(e,t)=>(pair.forEach(t,(n,r)=>Ri(e,n,r)),e),ea=(e,t=[],n=[])=>Ni(Mi(Ar(e),t),n),na=(e,t)=>{const n=Ar("canvas");return n.height=t,n.width=e,n},ra=null,Li=e=>`${e.left}:${e.right};`,sa=e=>e.map(Li).join(""),Vi=e=>L(e,(t,n)=>`${n}:${t};`).join(""),ia=(e,t)=>e.querySelector(t),oa=(e,t)=>e.querySelectorAll(t),ca=e=>Wt.getElementById(e),Or=e=>Ui.parseFromString(`<html><body>${e}</body></html>`,"text/html").body,la=e=>xr(Or(e).childNodes),aa=e=>Or(e).firstElementChild,ua=(e,t)=>e.replaceWith(t),da=(e,t,n)=>e.insertBefore(t,n),Ur=(e,t)=>e.appendChild(t),ha=Wt.ELEMENT_NODE,fa=Wt.TEXT_NODE,ga=Wt.CDATA_SECTION_NODE,pa=Wt.COMMENT_NODE,ma=Wt.DOCUMENT_NODE,ya=Wt.DOCUMENT_TYPE_NODE,wa=Wt.DOCUMENT_FRAGMENT_NODE,_a=(e,t)=>e.nodeType===t,Sa=(e,t)=>{let n=t.parentNode;for(;n&&n!==e;)n=n.parentNode;return n===e},fe=Symbol,ba=e=>typeof e=="symbol",ka=()=>new Date,Mr=Date.now,Ea=e=>{if(e<6e4){const i=metric.prefix(e,-1);return math.round(i.n*100)/100+i.prefix+"s"}e=math.floor(e/1e3);const t=e%60,n=math.floor(e/60)%60,r=math.floor(e/3600)%24,s=math.floor(e/86400);return s>0?s+"d"+(r>0||n>30?" "+(n>30?r+1:r)+"h":""):r>0?r+"h"+(n>0||t>30?" "+(t>30?n+1:n)+"min":""):n+"min"+(t>0?" "+t+"s":"")},Nr=fe(),Br=fe(),Rr=fe(),Pi=fe(),Lr=fe(),Vr=fe(),Pr=fe(),kn=fe(),Fr=fe(),Fi=e=>{const t=[],n=[];let r=0;for(;r<e.length;r++){const s=e[r];s.constructor===String||s.constructor===Number?t.push(s):s.constructor===Object&&n.push(JSON.stringify(s))}return n},zr=[Lr,Pr,kn,Rr];let Xn=0,jr=Mr();const Ca=(e,t)=>{const n=zr[Xn],r=env.getVariable("log"),s=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return Xn=(Xn+1)%zr.length,t+=": ",s?(...i)=>{const o=time.getUnixTime(),c=o-jr;jr=o,e(n,t,Fr,...i.map(a=>typeof a=="string"||typeof a=="symbol"?a:JSON.stringify(a)),n," +"+c+"ms")}:func.nop},$r={[Nr]:he("font-weight","bold"),[Br]:he("font-weight","normal"),[Rr]:he("color","blue"),[Lr]:he("color","green"),[Pi]:he("color","grey"),[Vr]:he("color","red"),[Pr]:he("color","purple"),[kn]:he("color","orange"),[Fr]:he("color","black")},En=xi?e=>{const t=[],n=[],r=E();let s=[],i=0;for(;i<e.length;i++){const o=e[i],c=$r[o];if(c!==void 0)r.set(c.left,c.right);else if(o.constructor===String||o.constructor===Number){const a=Vi(r);i>0||a.length>0?(t.push("%c"+o),n.push(a)):t.push(o)}else break}for(i>0&&(s=n,s.unshift(t.join("")));i<e.length;i++){const o=e[i];o instanceof Symbol||s.push(o)}return s}:Fi,Zr=(...e)=>{console.log(...En(e)),oe.forEach(t=>t.print(e))},zi=(...e)=>{console.warn(...En(e)),e.unshift(kn),oe.forEach(t=>t.print(e))},Da=e=>{console.error(e),oe.forEach(t=>t.printError(e))},Hr=(e,t)=>{env.isBrowser&&console.log("%c                      ",`font-size: ${t}px; background-size: contain; background-repeat: no-repeat; background-image: url(${e})`),oe.forEach(n=>n.printImg(e,t))},Ia=(e,t)=>Hr(`data:image/gif;base64,${e}`,t),Ta=(...e)=>{console.group(...En(e)),oe.forEach(t=>t.group(e))},Aa=(...e)=>{console.groupCollapsed(...En(e)),oe.forEach(t=>t.groupCollapsed(e))},xa=()=>{console.groupEnd(),oe.forEach(e=>e.groupEnd())},Oa=e=>oe.forEach(t=>t.printDom(e())),Ua=(e,t)=>Hr(e.toDataURL(),t),oe=O(),Gr=e=>{const t=[],n=new Map;let r=0;for(;r<e.length;r++){const s=e[r],i=$r[s];if(i!==void 0)n.set(i.left,i.right);else if(s.constructor===String||s.constructor===Number){const o=dom.element("span",[pair.create("style",dom.mapToStyleString(n))],[dom.text(s.toString())]);o.innerHTML===""&&(o.innerHTML="&nbsp;"),t.push(o)}else break}for(;r<e.length;r++){let s=e[r];s instanceof Symbol||(s.constructor!==String&&s.constructor!==Number&&(s=" "+json.stringify(s)+" "),t.push(dom.element("span",[],[dom.text(s)])))}return t},Wr="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class ji{constructor(t){this.dom=t,this.ccontainer=this.dom,this.depth=0,oe.add(this)}group(t,n=!1){eventloop.enqueue(()=>{const r=dom.element("span",[pair.create("hidden",n),pair.create("style","color:grey;font-size:120%;")],[dom.text("\u25BC")]),s=dom.element("span",[pair.create("hidden",!n),pair.create("style","color:grey;font-size:125%;")],[dom.text("\u25B6")]),i=dom.element("div",[pair.create("style",`${Wr};padding-left:${this.depth*10}px`)],[r,s,dom.text(" ")].concat(Gr(t))),o=dom.element("div",[pair.create("hidden",n)]),c=dom.element("div",[],[i,o]);dom.append(this.ccontainer,[c]),this.ccontainer=o,this.depth++,dom.addEventListener(i,"click",a=>{o.toggleAttribute("hidden"),r.toggleAttribute("hidden"),s.toggleAttribute("hidden")})})}groupCollapsed(t){this.group(t,!0)}groupEnd(){eventloop.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(t){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("div",[pair.create("style",`${Wr};padding-left:${this.depth*10}px`)],Gr(t))])})}printError(t){this.print([common.RED,common.BOLD,t.toString()])}printImg(t,n){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("img",[pair.create("src",t),pair.create("height",`${math.round(n*1.5)}px`)])])})}printDom(t){eventloop.enqueue(()=>{dom.append(this.ccontainer,[t])})}destroy(){eventloop.enqueue(()=>{oe.delete(this)})}}const Ma=e=>new ji(e),Na=e=>common.createModuleLogger(Zr,e),Ba=(e,t)=>({[Symbol.iterator](){return this},next(){const n=e.next();return{value:n.done?void 0:t(n.value),done:n.done}}}),Jr=e=>({[Symbol.iterator](){return this},next:e}),$i=(e,t)=>Jr(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),Qn=(e,t)=>Jr(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}}),Ra=()=>Object.create(null),Zi=Object.assign,Hi=Object.keys,Gi=(e,t)=>{for(const n in e)t(e[n],n)},La=(e,t)=>{const n=[];for(const r in e)n.push(t(e[r],r));return n},Kr=e=>Hi(e).length,Va=(e,t)=>{for(const n in e)if(t(e[n],n))return!0;return!1},Wi=e=>{for(const t in e)return!1;return!0},Ji=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},Ki=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Yi=(e,t)=>e===t||Kr(e)===Kr(t)&&Ji(e,(n,r)=>(n!==void 0||Ki(t,r))&&t[r]===n);class Pa extends null{constructor(t,n){super(),this.doc=t,this.awareness=n}}class qn{constructor(t,n){this.clock=t,this.len=n}}class He{constructor(){this.clients=new Map}}const Ge=(e,t,n)=>t.clients.forEach((r,s)=>{const i=e.doc.store.clients.get(s);for(let o=0;o<r.length;o++){const c=r[o];gs(e,i,c.clock,c.len,n)}}),Xi=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const s=_t((n+r)/2),i=e[s],o=i.clock;if(o<=t){if(t<o+i.len)return s;n=s+1}else r=s-1}return null},We=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&Xi(n,t.clock)!==null},tr=e=>{e.clients.forEach(t=>{t.sort((s,i)=>s.clock-i.clock);let n,r;for(n=1,r=1;n<t.length;n++){const s=t[r-1],i=t[n];s.clock+s.len>=i.clock?s.len=x(s.len,i.clock+i.len-s.clock):(r<n&&(t[r]=i),r++)}t.length=r})},Je=e=>{const t=new He;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,s)=>{if(!t.clients.has(s)){const i=r.slice();for(let o=n+1;o<e.length;o++)ct(i,e[o].clients.get(s)||[]);t.clients.set(s,i)}});return tr(t),t},ln=(e,t,n,r)=>{S(e.clients,t,()=>[]).push(new qn(n,r))},er=()=>new He,Yr=e=>{const t=er();return e.clients.forEach((n,r)=>{const s=[];for(let i=0;i<n.length;i++){const o=n[i];if(o.deleted){const c=o.id.clock;let a=o.length;if(i+1<n.length)for(let h=n[i+1];i+1<n.length&&h.deleted;h=n[++i+1])a+=h.length;s.push(new qn(c,a))}}s.length>0&&t.clients.set(r,s)}),t},ce=(e,t)=>{Q(e.restEncoder,t.clients.size),at(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),Q(e.restEncoder,n);const s=r.length;Q(e.restEncoder,s);for(let i=0;i<s;i++){const o=r[i];e.writeDsClock(o.clock),e.writeDsLen(o.len)}})},ge=e=>{const t=new He,n=decoding.readVarUint(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const s=decoding.readVarUint(e.restDecoder),i=decoding.readVarUint(e.restDecoder);if(i>0){const o=map.setIfUndefined(t.clients,s,()=>[]);for(let c=0;c<i;c++)o.push(new qn(e.readDsClock(),e.readDsLen()))}}return t},Xr=(e,t,n)=>{const r=new He,s=decoding.readVarUint(e.restDecoder);for(let i=0;i<s;i++){e.resetDsCurVal();const o=decoding.readVarUint(e.restDecoder),c=decoding.readVarUint(e.restDecoder),a=n.clients.get(o)||[],h=ht(n,o);for(let u=0;u<c;u++){const g=e.readDsClock(),m=g+e.readDsLen();if(g<h){h<m&&ln(r,o,h,m-h);let y=Kt(a,g),k=a[y];for(!k.deleted&&k.id.clock<g&&(a.splice(y+1,0,Fn(t,k,g-k.id.clock)),y++);y<a.length&&(k=a[y++],k.id.clock<m);)k.deleted||(m<k.id.clock+k.length&&a.splice(y,0,Fn(t,k,m-k.id.clock)),k.delete(t))}else ln(r,o,g,m-g)}}if(r.clients.size>0){const i=new le;return encoding.writeVarUint(i.restEncoder,0),ce(i,r),i.toUint8Array()}return null},Qi=(e,t)=>{if(e.clients.size!==t.clients.size)return!1;for(const[n,r]of e.clients.entries()){const s=t.clients.get(n);if(s===void 0||r.length!==s.length)return!1;for(let i=0;i<r.length;i++){const o=r[i],c=s[i];if(o.clock!==c.clock||o.len!==c.len)return!1}}return!0},Qr=Cr;class Re extends ae{constructor({guid:t=Ci(),collectionid:n=null,gc:r=!0,gcFilter:s=()=>!0,meta:i=null,autoLoad:o=!1,shouldLoad:c=!0}={}){super(),this.gc=r,this.gcFilter=s,this.clientID=Qr(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new ds,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=o,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=Sn(h=>{this.on("load",()=>{this.isLoaded=!0,h(this)})});const a=()=>Sn(h=>{const u=g=>{(g===void 0||g===!0)&&(this.off("sync",u),h())};this.on("sync",u)});this.on("sync",h=>{h===!1&&this.isSynced&&(this.whenSynced=a()),this.isSynced=h===void 0||h===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[])}),this.whenSynced=a()}load(){const t=this._item;t!==null&&!this.shouldLoad&&tt(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(at(this.subdocs).map(t=>t.guid))}transact(t,n=null){return tt(this,t,n)}get(t,n=bt){const r=S(this.share,t,()=>{const i=new n;return i._integrate(this,null),i}),s=r.constructor;if(n!==bt&&s!==n)if(s===bt){const i=new n;i._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=i}),i._start=r._start;for(let o=i._start;o!==null;o=o.right)o.parent=i;return i._length=r._length,this.share.set(t,i),i._integrate(this,null),i}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,ke)}getText(t=""){return this.get(t,qe)}getMap(t=""){return this.get(t,Ve)}getXmlFragment(t=""){return this.get(t,Pe)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){at(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new Re(wr(zn({guid:this.guid},n.opts),{shouldLoad:!1})),n.doc._item=t,tt(t.parent.doc,r=>{const s=n.doc;t.deleted||r.subdocsAdded.add(s),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,n){super.on(t,n)}off(t,n){super.off(t,n)}}class Cn{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return decoding.readVarUint(this.restDecoder)}readDsLen(){return decoding.readVarUint(this.restDecoder)}}class Jt extends null{readLeftID(){return N(decoding.readVarUint(this.restDecoder),decoding.readVarUint(this.restDecoder))}readRightID(){return N(decoding.readVarUint(this.restDecoder),decoding.readVarUint(this.restDecoder))}readClient(){return decoding.readVarUint(this.restDecoder)}readInfo(){return decoding.readUint8(this.restDecoder)}readString(){return decoding.readVarString(this.restDecoder)}readParentInfo(){return decoding.readVarUint(this.restDecoder)===1}readTypeRef(){return decoding.readVarUint(this.restDecoder)}readLen(){return decoding.readVarUint(this.restDecoder)}readAny(){return decoding.readAny(this.restDecoder)}readBuf(){return buffer.copyUint8Array(decoding.readVarUint8Array(this.restDecoder))}readJSON(){return JSON.parse(decoding.readVarString(this.restDecoder))}readKey(){return decoding.readVarString(this.restDecoder)}}class qi{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=decoding.readVarUint(this.restDecoder),this.dsCurrVal}readDsLen(){const t=decoding.readVarUint(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class $t extends null{constructor(t){super(t),this.keys=[],decoding.readVarUint(t),this.keyClockDecoder=new decoding.IntDiffOptRleDecoder(decoding.readVarUint8Array(t)),this.clientDecoder=new decoding.UintOptRleDecoder(decoding.readVarUint8Array(t)),this.leftClockDecoder=new decoding.IntDiffOptRleDecoder(decoding.readVarUint8Array(t)),this.rightClockDecoder=new decoding.IntDiffOptRleDecoder(decoding.readVarUint8Array(t)),this.infoDecoder=new decoding.RleDecoder(decoding.readVarUint8Array(t),decoding.readUint8),this.stringDecoder=new decoding.StringDecoder(decoding.readVarUint8Array(t)),this.parentInfoDecoder=new decoding.RleDecoder(decoding.readVarUint8Array(t),decoding.readUint8),this.typeRefDecoder=new decoding.UintOptRleDecoder(decoding.readVarUint8Array(t)),this.lenDecoder=new decoding.UintOptRleDecoder(decoding.readVarUint8Array(t))}readLeftID(){return new Ye(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Ye(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return decoding.readAny(this.restDecoder)}readBuf(){return decoding.readVarUint8Array(this.restDecoder)}readJSON(){return decoding.readAny(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Ke{constructor(){this.restEncoder=pn()}toUint8Array(){return jt(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){Q(this.restEncoder,t)}writeDsLen(t){Q(this.restEncoder,t)}}class Le extends Ke{writeLeftID(t){Q(this.restEncoder,t.client),Q(this.restEncoder,t.clock)}writeRightID(t){Q(this.restEncoder,t.client),Q(this.restEncoder,t.clock)}writeClient(t){Q(this.restEncoder,t)}writeInfo(t){$n(this.restEncoder,t)}writeString(t){je(this.restEncoder,t)}writeParentInfo(t){Q(this.restEncoder,t?1:0)}writeTypeRef(t){Q(this.restEncoder,t)}writeLen(t){Q(this.restEncoder,t)}writeAny(t){cn(this.restEncoder,t)}writeBuf(t){Nt(this.restEncoder,t)}writeJSON(t){je(this.restEncoder,JSON.stringify(t))}writeKey(t){je(this.restEncoder,t)}}class vn{constructor(){this.restEncoder=pn(),this.dsCurrVal=0}toUint8Array(){return jt(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,Q(this.restEncoder,n)}writeDsLen(t){t===0&&de(),Q(this.restEncoder,t-1),this.dsCurrVal+=t}}class le extends vn{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Hn,this.clientEncoder=new _n,this.leftClockEncoder=new Hn,this.rightClockEncoder=new Hn,this.infoEncoder=new kr($n),this.stringEncoder=new Si,this.parentInfoEncoder=new kr($n),this.typeRefEncoder=new _n,this.lenEncoder=new _n}toUint8Array(){const t=pn();return Q(t,0),Nt(t,this.keyClockEncoder.toUint8Array()),Nt(t,this.clientEncoder.toUint8Array()),Nt(t,this.leftClockEncoder.toUint8Array()),Nt(t,this.rightClockEncoder.toUint8Array()),Nt(t,jt(this.infoEncoder)),Nt(t,this.stringEncoder.toUint8Array()),Nt(t,jt(this.parentInfoEncoder)),Nt(t,this.typeRefEncoder.toUint8Array()),Nt(t,this.lenEncoder.toUint8Array()),mn(t,jt(this.restEncoder)),jt(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){cn(this.restEncoder,t)}writeBuf(t){Nt(this.restEncoder,t)}writeJSON(t){cn(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const to=(e,t,n,r)=>{r=x(r,t[0].id.clock);const s=Kt(t,r);Q(e.restEncoder,t.length-s),e.writeClient(n),Q(e.restEncoder,r);const i=t[s];i.write(e,r-i.id.clock);for(let o=s+1;o<t.length;o++)t[o].write(e,0)},nr=(e,t,n)=>{const r=new Map;n.forEach((s,i)=>{ht(t,i)>s&&r.set(i,s)}),an(t).forEach((s,i)=>{n.has(i)||r.set(i,0)}),Q(e.restEncoder,r.size),at(r.entries()).sort((s,i)=>i[0]-s[0]).forEach(([s,i])=>{to(e,t.clients.get(s),s,i)})},eo=(e,t)=>{const n=map.create(),r=decoding.readVarUint(e.restDecoder);for(let s=0;s<r;s++){const i=decoding.readVarUint(e.restDecoder),o=new Array(i),c=e.readClient();let a=decoding.readVarUint(e.restDecoder);n.set(c,{i:0,refs:o});for(let h=0;h<i;h++){const u=e.readInfo();switch(binary.BITS5&u){case 0:{const g=e.readLen();o[h]=new Bt(N(c,a),g),a+=g;break}case 10:{const g=decoding.readVarUint(e.restDecoder);o[h]=new Ut(N(c,a),g),a+=g;break}default:{const g=(u&(binary.BIT7|binary.BIT8))===0,m=new q(N(c,a),null,(u&binary.BIT8)===binary.BIT8?e.readLeftID():null,null,(u&binary.BIT7)===binary.BIT7?e.readRightID():null,g?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,g&&(u&binary.BIT6)===binary.BIT6?e.readString():null,Js(e,u));o[h]=m,a+=m.length}}}}return n},no=(e,t,n)=>{const r=[];let s=array.from(n.keys()).sort((y,k)=>y-k);if(s.length===0)return null;const i=()=>{if(s.length===0)return null;let y=n.get(s[s.length-1]);for(;y.refs.length===y.i;)if(s.pop(),s.length>0)y=n.get(s[s.length-1]);else return null;return y};let o=i();if(o===null)return null;const c=new ds,a=new Map,h=(y,k)=>{const P=a.get(y);(P==null||P>k)&&a.set(y,k)};let u=o.refs[o.i++];const g=new Map,m=()=>{for(const y of r){const k=y.id.client,P=n.get(k);P?(P.i--,c.clients.set(k,P.refs.slice(P.i)),n.delete(k),P.i=0,P.refs=[]):c.clients.set(k,[y]),s=s.filter(ut=>ut!==k)}r.length=0};for(;;){if(u.constructor!==Ut){const k=map.setIfUndefined(g,u.id.client,()=>ht(t,u.id.client))-u.id.clock;if(k<0)r.push(u),h(u.id.client,u.id.clock-1),m();else{const P=u.getMissing(e,t);if(P!==null){r.push(u);const ut=n.get(P)||{refs:[],i:0};if(ut.refs.length===ut.i)h(P,ht(t,P)),m();else{u=ut.refs[ut.i++];continue}}else(k===0||k<u.length)&&(u.integrate(e,k),g.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(o!==null&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=i(),o===null)break;u=o.refs[o.i++]}}if(c.clients.size>0){const y=new le;return nr(y,c,new Map),encoding.writeVarUint(y.restEncoder,0),{missing:a,update:y.toUint8Array()}}return null},ro=(e,t)=>nr(e,t.doc.store,t.beforeState),qr=(e,t,n,r=new $t(e))=>tt(t,s=>{s.local=!1;let i=!1;const o=s.doc,c=o.store,a=eo(r,o),h=no(s,c,a),u=c.pendingStructs;if(u){for(const[m,y]of u.missing)if(y<ht(c,m)){i=!0;break}if(h){for(const[m,y]of h.missing){const k=u.missing.get(m);(k==null||k>y)&&u.missing.set(m,y)}u.update=xn([u.update,h.update])}}else c.pendingStructs=h;const g=Xr(r,s,c);if(c.pendingDs){const m=new $t(decoding.createDecoder(c.pendingDs));decoding.readVarUint(m.restDecoder);const y=Xr(m,s,c);g&&y?c.pendingDs=xn([g,y]):c.pendingDs=g||y}else c.pendingDs=g;if(i){const m=c.pendingStructs.update;c.pendingStructs=null,rr(s.doc,m)}},n,!1),Fa=(e,t,n)=>qr(e,t,n,new Jt(e)),rr=(e,t,n,r=$t)=>{const s=decoding.createDecoder(t);qr(s,e,n,new r(s))},za=(e,t,n)=>rr(e,t,n,Jt),so=(e,t,n=new Map)=>{nr(e,t.store,n),ce(e,Yr(t.store))},io=(e,t=new Uint8Array([0]),n=new le)=>{const r=es(t);so(n,e,r);const s=[n.toUint8Array()];if(e.store.pendingDs&&s.push(e.store.pendingDs),e.store.pendingStructs&&s.push(ks(e.store.pendingStructs.update,t)),s.length>1){if(n.constructor===Le)return Co(s.map((i,o)=>o===0?i:To(i)));if(n.constructor===le)return xn(s)}return s[0]},ja=(e,t)=>io(e,t,new Le),ts=e=>{const t=new Map,n=decoding.readVarUint(e.restDecoder);for(let r=0;r<n;r++){const s=decoding.readVarUint(e.restDecoder),i=decoding.readVarUint(e.restDecoder);t.set(s,i)}return t},es=e=>ts(new Cn(decoding.createDecoder(e))),sr=(e,t)=>(encoding.writeVarUint(e.restEncoder,t.size),array.from(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{encoding.writeVarUint(e.restEncoder,n),encoding.writeVarUint(e.restEncoder,r)}),e),oo=(e,t)=>sr(e,an(t.store)),co=(e,t=new vn)=>(e instanceof Map?sr(t,e):oo(t,e),t.toUint8Array()),$a=e=>co(e,new Ke);class lo{constructor(){this.l=[]}}const ns=()=>new lo,rs=(e,t)=>e.l.push(t),ss=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(s=>t!==s),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},is=(e,t,n)=>Gn(e.l,[t,n]);class Ye{constructor(t,n){this.client=t,this.clock=n}}const Xe=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,N=(e,t)=>new Ye(e,t),os=(e,t)=>{encoding.writeVarUint(e,t.client),encoding.writeVarUint(e,t.clock)},cs=e=>N(decoding.readVarUint(e),decoding.readVarUint(e)),ls=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw de()},Dn=(e,t)=>{for(;t!==null;){if(t.parent===e)return!0;t=t.parent._item}return!1},Za=e=>{const t=[];let n=e._start;for(;n;)t.push(n),n=n.right;console.log("Children: ",t),console.log("Children content: ",t.filter(r=>!r.deleted).map(r=>r.content))};class Ha{constructor(t,n=t.getMap("users")){const r=new Map;this.yusers=n,this.doc=t,this.clients=new Map,this.dss=r;const s=(i,o)=>{const c=i.get("ds"),a=i.get("ids"),h=u=>this.clients.set(u,o);c.observe(u=>{u.changes.added.forEach(g=>{g.content.getContent().forEach(m=>{m instanceof Uint8Array&&this.dss.set(o,Je([this.dss.get(o)||er(),ge(new Cn(decoding.createDecoder(m)))]))})})}),this.dss.set(o,Je(c.map(u=>ge(new Cn(decoding.createDecoder(u)))))),a.observe(u=>u.changes.added.forEach(g=>g.content.getContent().forEach(h))),a.forEach(h)};n.observe(i=>{i.keysChanged.forEach(o=>s(n.get(o),o))}),n.forEach(s)}setUserMapping(t,n,r,{filter:s=()=>!0}={}){const i=this.yusers;let o=i.get(r);o||(o=new Ve,o.set("ids",new ke),o.set("ds",new ke),i.set(r,o)),o.get("ids").push([n]),i.observe(c=>{setTimeout(()=>{const a=i.get(r);if(a!==o){o=a,this.clients.forEach((g,m)=>{r===g&&o.get("ids").push([m])});const h=new Ke,u=this.dss.get(r);u&&(ce(h,u),o.get("ds").push([h.toUint8Array()]))}},0)}),t.on("afterTransaction",c=>{setTimeout(()=>{const a=o.get("ds"),h=c.deleteSet;if(c.local&&h.clients.size>0&&s(c,h)){const u=new Ke;ce(u,h),a.push([u.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(const[n,r]of this.dss.entries())if(We(r,t))return n;return null}}class ir{constructor(t,n,r,s=0){this.type=t,this.tname=n,this.item=r,this.assoc=s}}const Ga=e=>{const t={};return e.type&&(t.type=e.type),e.tname&&(t.tname=e.tname),e.item&&(t.item=e.item),e.assoc!=null&&(t.assoc=e.assoc),t},Wa=e=>new ir(e.type==null?null:N(e.type.client,e.type.clock),e.tname||null,e.item==null?null:N(e.item.client,e.item.clock),e.assoc==null?0:e.assoc);class ao{constructor(t,n,r=0){this.type=t,this.index=n,this.assoc=r}}const uo=(e,t,n=0)=>new ao(e,t,n),In=(e,t,n)=>{let r=null,s=null;return e._item===null?s=ls(e):r=N(e._item.id.client,e._item.id.clock),new ir(r,s,t,n)},Ja=(e,t,n=0)=>{let r=e._start;if(n<0){if(t===0)return In(e,null,n);t--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>t)return In(e,N(r.id.client,r.id.clock+t),n);t-=r.length}if(r.right===null&&n<0)return In(e,r.lastId,n);r=r.right}return In(e,null,n)},ho=(e,t)=>{const{type:n,tname:r,item:s,assoc:i}=t;if(s!==null)encoding.writeVarUint(e,0),os(e,s);else if(r!==null)encoding.writeUint8(e,1),encoding.writeVarString(e,r);else if(n!==null)encoding.writeUint8(e,2),os(e,n);else throw error.unexpectedCase();return encoding.writeVarInt(e,i),e},Ka=e=>{const t=encoding.createEncoder();return ho(t,e),encoding.toUint8Array(t)},fo=e=>{let t=null,n=null,r=null;switch(decoding.readVarUint(e)){case 0:r=cs(e);break;case 1:n=decoding.readVarString(e);break;case 2:t=cs(e)}const s=decoding.hasContent(e)?decoding.readVarInt(e):0;return new ir(t,n,r,s)},Ya=e=>fo(decoding.createDecoder(e)),Xa=(e,t)=>{const n=t.store,r=e.item,s=e.type,i=e.tname,o=e.assoc;let c=null,a=0;if(r!==null){if(ht(n,r.client)<=r.clock)return null;const h=mr(n,r),u=h.item;if(!(u instanceof q))return null;if(c=u.parent,c._item===null||!c._item.deleted){a=u.deleted||!u.countable?0:h.diff+(o>=0?0:1);let g=u.left;for(;g!==null;)!g.deleted&&g.countable&&(a+=g.length),g=g.left}}else{if(i!==null)c=t.get(i);else if(s!==null){if(ht(n,s.client)<=s.clock)return null;const{item:h}=mr(n,s);if(h instanceof q&&h.content instanceof Xt)c=h.content.type;else return null}else throw error.unexpectedCase();o>=0?a=c._length:a=0}return uo(c,a,e.assoc)},Qa=(e,t)=>e===t||e!==null&&t!==null&&e.tname===t.tname&&Xe(e.item,t.item)&&Xe(e.type,t.type)&&e.assoc===t.assoc;class as{constructor(t,n){this.ds=t,this.sv=n}}const qa=(e,t)=>{const n=e.ds.clients,r=t.ds.clients,s=e.sv,i=t.sv;if(s.size!==i.size||n.size!==r.size)return!1;for(const[o,c]of s.entries())if(i.get(o)!==c)return!1;for(const[o,c]of n.entries()){const a=r.get(o)||[];if(c.length!==a.length)return!1;for(let h=0;h<c.length;h++){const u=c[h],g=a[h];if(u.clock!==g.clock||u.len!==g.len)return!1}}return!0},go=(e,t=new vn)=>(ce(t,e.ds),sr(t,e.sv),t.toUint8Array()),tu=e=>go(e,new Ke),po=(e,t=new qi(decoding.createDecoder(e)))=>new as(ge(t),ts(t)),eu=e=>po(e,new Cn(decoding.createDecoder(e))),us=(e,t)=>new as(e,t),nu=us(er(),new Map),ru=e=>us(Yr(e.store),an(e.store)),_e=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!We(t.ds,e.id),or=(e,t)=>{const n=S(e.meta,or,O),r=e.doc.store;n.has(t)||(t.sv.forEach((s,i)=>{s<ht(r,i)&&It(e,N(i,s))}),Ge(e,t.ds,s=>{}),n.add(t))},su=(e,t,n=new Re)=>{if(e.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:r,ds:s}=t,i=new le;return e.transact(o=>{let c=0;r.forEach(a=>{a>0&&c++}),encoding.writeVarUint(i.restEncoder,c);for(const[a,h]of r){if(h===0)continue;h<ht(e.store,a)&&It(o,N(a,h));const u=e.store.clients.get(a)||[],g=Kt(u,h-1);encoding.writeVarUint(i.restEncoder,g+1),i.writeClient(a),encoding.writeVarUint(i.restEncoder,0);for(let m=0;m<=g;m++)u[m].write(i,0)}ce(i,s)}),rr(n,i.toUint8Array(),"snapshot"),n},mo=(e,t,n=$t)=>{const r=new n(decoding.createDecoder(t)),s=new Se(r,!1);for(let o=s.curr;o!==null;o=s.next())if((e.sv.get(o.id.client)||0)<o.id.clock+o.length)return!1;const i=Je([e.ds,ge(r)]);return Qi(e.ds,i)},iu=(e,t)=>mo(e,t,Jt);class ds{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const an=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const s=n[n.length-1];t.set(r,s.id.clock+s.length)}),t},ht=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},hs=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw de()}n.push(t)},Kt=(e,t)=>{let n=0,r=e.length-1,s=e[r],i=s.id.clock;if(i===t)return r;let o=_t(t/(i+s.length-1)*r);for(;n<=r;){if(s=e[o],i=s.id.clock,i<=t){if(t<i+s.length)return o;n=o+1}else r=o-1;o=_t((n+r)/2)}throw de()},Tn=(e,t)=>{const n=e.clients.get(t.client);return n[Kt(n,t.clock)]},cr=(e,t,n)=>{const r=Kt(t,n),s=t[r];return s.id.clock<n&&s instanceof q?(t.splice(r+1,0,Fn(e,s,n-s.id.clock)),r+1):r},It=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[cr(e,n,t.clock)]},fs=(e,t,n)=>{const r=t.clients.get(n.client),s=Kt(r,n.clock),i=r[s];return n.clock!==i.id.clock+i.length-1&&i.constructor!==Bt&&r.splice(s+1,0,Fn(e,i,n.clock-i.id.clock+1)),i},yo=(e,t,n)=>{const r=e.clients.get(t.id.client);r[Kt(r,t.id.clock)]=n},gs=(e,t,n,r,s)=>{if(r===0)return;const i=n+r;let o=cr(e,t,n),c;do c=t[o++],i<c.id.clock+c.length&&cr(e,t,i),s(c);while(o<t.length&&t[o].id.clock<i)};class wo{constructor(t,n,r){this.doc=t,this.deleteSet=new He,this.beforeState=an(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const ps=(e,t)=>t.deleteSet.clients.size===0&&!v(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(tr(t.deleteSet),ro(e,t),ce(e,t.deleteSet),!0),ms=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&S(e.changed,t,O).add(n)},An=(e,t)=>{let n=e[t],r=e[t-1],s=t;for(;s>0;n=r,r=e[--s-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof q&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const i=t-s;return i&&e.splice(t+1-i,i),i},ys=(e,t,n)=>{for(const[r,s]of e.clients.entries()){const i=t.clients.get(r);for(let o=s.length-1;o>=0;o--){const c=s[o],a=c.clock+c.len;for(let h=Kt(i,c.clock),u=i[h];h<i.length&&u.id.clock<a;u=i[++h]){const g=i[h];if(c.clock+c.len<=g.id.clock)break;g instanceof q&&g.deleted&&!g.keep&&n(g)&&g.gc(t,!1)}}}},ws=(e,t)=>{e.clients.forEach((n,r)=>{const s=t.clients.get(r);for(let i=n.length-1;i>=0;i--){const o=n[i],c=Ae(s.length-1,1+Kt(s,o.clock+o.len-1));for(let a=c,h=s[a];a>0&&h.id.clock>=o.clock;h=s[a])a-=1+An(s,a)}})},cu=(e,t,n)=>{ys(e,t,n),ws(e,t)},_s=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,s=r.store,i=n.deleteSet,o=n._mergeStructs;try{tr(i),n.afterState=an(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const c=[];n.changed.forEach((a,h)=>c.push(()=>{(h._item===null||!h._item.deleted)&&h._callObserver(n,a)})),c.push(()=>{n.changedParentTypes.forEach((a,h)=>{h._dEH.l.length>0&&(h._item===null||!h._item.deleted)&&(a=a.filter(u=>u.target._item===null||!u.target._item.deleted),a.forEach(u=>{u.currentTarget=h,u._path=null}),a.sort((u,g)=>u.path.length-g.path.length),is(h._dEH,a,n))})}),c.push(()=>r.emit("afterTransaction",[n,r])),Gn(c,[]),n._needFormattingCleanup&&jo(n)}finally{r.gc&&ys(i,s,r.gcFilter),ws(i,s),n.afterState.forEach((u,g)=>{const m=n.beforeState.get(g)||0;if(m!==u){const y=s.clients.get(g),k=x(Kt(y,m),1);for(let P=y.length-1;P>=k;)P-=1+An(y,P)}});for(let u=o.length-1;u>=0;u--){const{client:g,clock:m}=o[u].id,y=s.clients.get(g),k=Kt(y,m);k+1<y.length&&An(y,k+1)>1||k>0&&An(y,k)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(Zr(kn,Nr,"[yjs] ",Br,Vr,"Changed the client-id because another client seems to be using it."),r.clientID=Qr()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new Le;ps(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new le;ps(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:c,subdocsLoaded:a,subdocsRemoved:h}=n;(c.size>0||h.size>0||a.size>0)&&(c.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),h.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:a,added:c,removed:h},r,n]),h.forEach(u=>u.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):_s(e,t+1)}}},tt=(e,t,n=null,r=!0)=>{const s=e._transactionCleanups;let i=!1,o=null;e._transaction===null&&(i=!0,e._transaction=new wo(e,n,r),s.push(e._transaction),s.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{o=t(e._transaction)}finally{if(i){const c=e._transaction===s[0];e._transaction=null,c&&_s(s,0)}}return o};class _o{constructor(t,n){this.insertions=n,this.deletions=t,this.meta=new Map}}const Ss=(e,t,n)=>{Ge(e,n.deletions,r=>{r instanceof q&&t.scope.some(s=>Dn(s,r))&&yr(r,!1)})},bs=(e,t,n)=>{let r=null,s=null;const i=e.doc,o=e.scope;if(tt(i,c=>{for(;t.length>0&&r===null;){const a=i.store,h=t.pop(),u=new Set,g=[];let m=!1;Ge(c,h.insertions,y=>{if(y instanceof q){if(y.redone!==null){let{item:k,diff:P}=mr(a,y.id);P>0&&(k=It(c,N(k.id.client,k.id.clock+P))),y=k}!y.deleted&&o.some(k=>Dn(k,y))&&g.push(y)}}),Ge(c,h.deletions,y=>{y instanceof q&&o.some(k=>Dn(k,y))&&!We(h.insertions,y.id)&&u.add(y)}),u.forEach(y=>{m=Ws(c,y,u,h.insertions,e.ignoreRemoteMapChanges,e)!==null||m});for(let y=g.length-1;y>=0;y--){const k=g[y];e.deleteFilter(k)&&(k.delete(c),m=!0)}r=m?h:null}c.changed.forEach((a,h)=>{a.has(null)&&h._searchMarker&&(h._searchMarker.length=0)}),s=c},e),r!=null){const c=s.changedParentTypes;e.emit("stack-item-popped",[{stackItem:r,type:n,changedParentTypes:c},e])}return r};class So extends ae{constructor(t,{captureTimeout:n=500,captureTransaction:r=a=>!0,deleteFilter:s=()=>!0,trackedOrigins:i=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:c=Et(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.doc=c,this.addToScope(t),this.deleteFilter=s,i.add(this),this.trackedOrigins=i,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=n,this.afterTransactionHandler=a=>{if(!this.captureTransaction(a)||!this.scope.some(ut=>a.changedParentTypes.has(ut))||!this.trackedOrigins.has(a.origin)&&(!a.origin||!this.trackedOrigins.has(a.origin.constructor)))return;const h=this.undoing,u=this.redoing,g=h?this.redoStack:this.undoStack;h?this.stopCapturing():u||this.clear(!1,!0);const m=new He;a.afterState.forEach((ut,ft)=>{const Xs=a.beforeState.get(ft)||0,Qs=ut-Xs;Qs>0&&ln(m,ft,Xs,Qs)});const y=Mr();let k=!1;if(this.lastChange>0&&y-this.lastChange<this.captureTimeout&&g.length>0&&!h&&!u){const ut=g[g.length-1];ut.deletions=Je([ut.deletions,a.deleteSet]),ut.insertions=Je([ut.insertions,m])}else g.push(new _o(a.deleteSet,m)),k=!0;!h&&!u&&(this.lastChange=y),Ge(a,a.deleteSet,ut=>{ut instanceof q&&this.scope.some(ft=>Dn(ft,ut))&&yr(ut,!0)});const P=[{stackItem:g[g.length-1],origin:a.origin,type:h?"redo":"undo",changedParentTypes:a.changedParentTypes},this];k?this.emit("stack-item-added",P):this.emit("stack-item-updated",P)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=Et(t)?t:[t],t.forEach(n=>{this.scope.every(r=>r!==n)&&(n.doc!==this.doc&&zi("[yjs#509] Not same Y.Doc"),this.scope.push(n))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,n=!0){(t&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{t&&(this.undoStack.forEach(s=>Ss(r,this,s)),this.undoStack=[]),n&&(this.redoStack.forEach(s=>Ss(r,this,s)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=bs(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=bs(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*bo(e){const t=decoding.readVarUint(e.restDecoder);for(let n=0;n<t;n++){const r=decoding.readVarUint(e.restDecoder),s=e.readClient();let i=decoding.readVarUint(e.restDecoder);for(let o=0;o<r;o++){const c=e.readInfo();if(c===10){const a=decoding.readVarUint(e.restDecoder);yield new Ut(N(s,i),a),i+=a}else if(binary.BITS5&c){const a=(c&(binary.BIT7|binary.BIT8))===0,h=new q(N(s,i),null,(c&binary.BIT8)===binary.BIT8?e.readLeftID():null,null,(c&binary.BIT7)===binary.BIT7?e.readRightID():null,a?e.readParentInfo()?e.readString():e.readLeftID():null,a&&(c&binary.BIT6)===binary.BIT6?e.readString():null,Js(e,c));yield h,i+=h.length}else{const a=e.readLen();yield new Bt(N(s,i),a),i+=a}}}}class Se{constructor(t,n){this.gen=bo(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ut);return this.curr}}const lu=e=>ko(e,Jt),ko=(e,t=$t)=>{const n=[],r=new t(decoding.createDecoder(e)),s=new Se(r,!1);for(let o=s.curr;o!==null;o=s.next())n.push(o);logging.print("Structs: ",n);const i=ge(r);logging.print("DeleteSet: ",i)},au=e=>Eo(e,Jt),Eo=(e,t=$t)=>{const n=[],r=new t(decoding.createDecoder(e)),s=new Se(r,!1);for(let i=s.curr;i!==null;i=s.next())n.push(i);return{structs:n,ds:ge(r)}};class lr{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Co=e=>xn(e,Jt,Le),vo=(e,t=vn,n=$t)=>{const r=new t,s=new Se(new n(decoding.createDecoder(e)),!1);let i=s.curr;if(i!==null){let o=0,c=i.id.client,a=i.id.clock!==0,h=a?0:i.id.clock+i.length;for(;i!==null;i=s.next())c!==i.id.client&&(h!==0&&(o++,encoding.writeVarUint(r.restEncoder,c),encoding.writeVarUint(r.restEncoder,h)),c=i.id.client,h=0,a=i.id.clock!==0),i.constructor===Ut&&(a=!0),a||(h=i.id.clock+i.length);h!==0&&(o++,encoding.writeVarUint(r.restEncoder,c),encoding.writeVarUint(r.restEncoder,h));const u=encoding.createEncoder();return encoding.writeVarUint(u,o),encoding.writeBinaryEncoder(u,r.restEncoder),r.restEncoder=u,r.toUint8Array()}else return encoding.writeVarUint(r.restEncoder,0),r.toUint8Array()},uu=e=>vo(e,Ke,Jt),Do=(e,t=$t)=>{const n=new Map,r=new Map,s=new Se(new t(decoding.createDecoder(e)),!1);let i=s.curr;if(i!==null){let o=i.id.client,c=i.id.clock;for(n.set(o,c);i!==null;i=s.next())o!==i.id.client&&(r.set(o,c),n.set(i.id.client,i.id.clock),o=i.id.client),c=i.id.clock+i.length;r.set(o,c)}return{from:n,to:r}},du=e=>Do(e,Jt),Io=(e,t)=>{if(e.constructor===Bt){const{client:n,clock:r}=e.id;return new Bt(N(n,r+t),e.length-t)}else if(e.constructor===Ut){const{client:n,clock:r}=e.id;return new Ut(N(n,r+t),e.length-t)}else{const n=e,{client:r,clock:s}=n.id;return new q(N(r,s+t),null,N(r,s+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},xn=(e,t=$t,n=le)=>{if(e.length===1)return e[0];const r=e.map(u=>new t(decoding.createDecoder(u)));let s=r.map(u=>new Se(u,!0)),i=null;const o=new n,c=new lr(o);for(;s=s.filter(m=>m.curr!==null),s.sort((m,y)=>{if(m.curr.id.client===y.curr.id.client){const k=m.curr.id.clock-y.curr.id.clock;return k===0?m.curr.constructor===y.curr.constructor?0:m.curr.constructor===Ut?1:-1:k}else return y.curr.id.client-m.curr.id.client}),s.length!==0;){const u=s[0],g=u.curr.id.client;if(i!==null){let m=u.curr,y=!1;for(;m!==null&&m.id.clock+m.length<=i.struct.id.clock+i.struct.length&&m.id.client>=i.struct.id.client;)m=u.next(),y=!0;if(m===null||m.id.client!==g||y&&m.id.clock>i.struct.id.clock+i.struct.length)continue;if(g!==i.struct.id.client)be(c,i.struct,i.offset),i={struct:m,offset:0},u.next();else if(i.struct.id.clock+i.struct.length<m.id.clock)if(i.struct.constructor===Ut)i.struct.length=m.id.clock+m.length-i.struct.id.clock;else{be(c,i.struct,i.offset);const k=m.id.clock-i.struct.id.clock-i.struct.length;i={struct:new Ut(N(g,i.struct.id.clock+i.struct.length),k),offset:0}}else{const k=i.struct.id.clock+i.struct.length-m.id.clock;k>0&&(i.struct.constructor===Ut?i.struct.length-=k:m=Io(m,k)),i.struct.mergeWith(m)||(be(c,i.struct,i.offset),i={struct:m,offset:0},u.next())}}else i={struct:u.curr,offset:0},u.next();for(let m=u.curr;m!==null&&m.id.client===g&&m.id.clock===i.struct.id.clock+i.struct.length&&m.constructor!==Ut;m=u.next())be(c,i.struct,i.offset),i={struct:m,offset:0}}i!==null&&(be(c,i.struct,i.offset),i=null),ar(c);const a=r.map(u=>ge(u)),h=Je(a);return ce(o,h),o.toUint8Array()},ks=(e,t,n=$t,r=le)=>{const s=es(t),i=new r,o=new lr(i),c=new n(decoding.createDecoder(e)),a=new Se(c,!1);for(;a.curr;){const u=a.curr,g=u.id.client,m=s.get(g)||0;if(a.curr.constructor===Ut){a.next();continue}if(u.id.clock+u.length>m)for(be(o,u,math.max(m-u.id.clock,0)),a.next();a.curr&&a.curr.id.client===g;)be(o,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===g&&a.curr.id.clock+a.curr.length<=m;)a.next()}ar(o);const h=ge(c);return ce(i,h),i.toUint8Array()},hu=(e,t)=>ks(e,t,Jt,Le),Es=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:encoding.toUint8Array(e.encoder.restEncoder)}),e.encoder.restEncoder=encoding.createEncoder(),e.written=0)},be=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Es(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),encoding.writeVarUint(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},ar=e=>{Es(e);const t=e.encoder.restEncoder;encoding.writeVarUint(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];encoding.writeVarUint(t,r.written),encoding.writeUint8Array(t,r.restEncoder)}},On=(e,t,n,r)=>{const s=new n(decoding.createDecoder(e)),i=new Se(s,!1),o=new r,c=new lr(o);for(let h=i.curr;h!==null;h=i.next())be(c,t(h),0);ar(c);const a=ge(s);return ce(o,a),o.toUint8Array()},Cs=({formatting:e=!0,subdocs:t=!0,yxml:n=!0}={})=>{let r=0;const s=map.create(),i=map.create(),o=map.create(),c=map.create();return c.set(null,null),a=>{switch(a.constructor){case Bt:case Ut:return a;case q:{const h=a,u=h.content;switch(u.constructor){case nn:break;case Xt:{if(n){const g=u.type;g instanceof tn&&(g.nodeName=map.setIfUndefined(i,g.nodeName,()=>"node-"+r)),g instanceof hn&&(g.hookName=map.setIfUndefined(i,g.hookName,()=>"hook-"+r))}break}case ve:{const g=u;g.arr=g.arr.map(()=>r);break}case en:{const g=u;g.content=new Uint8Array([r]);break}case rn:{const g=u;t&&(g.opts={},g.doc.guid=r+"");break}case Ce:{const g=u;g.embed={};break}case mt:{const g=u;e&&(g.key=map.setIfUndefined(o,g.key,()=>r+""),g.value=map.setIfUndefined(c,g.value,()=>({i:r})));break}case fn:{const g=u;g.arr=g.arr.map(()=>r);break}case Yt:{const g=u;g.str=string.repeat(r%10+"",g.str.length);break}default:error.unexpectedCase()}return h.parentSub&&(h.parentSub=map.setIfUndefined(s,h.parentSub,()=>r+"")),r++,a}default:error.unexpectedCase()}}},fu=(e,t)=>On(e,Cs(t),Jt,Le),gu=(e,t)=>On(e,Cs(t),$t,le),pu=e=>On(e,f.id,Jt,le),To=e=>On(e,f.id,$t,Le),vs="You must not compute changes after the event-handler fired.";class Un{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Ao(this.currentTarget,this.target))}deletes(t){return We(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw $e(vs);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(s=>{if(s!==null){const i=n._map.get(s);let o,c;if(this.adds(i)){let a=i.left;for(;a!==null&&this.adds(a);)a=a.left;if(this.deletes(i))if(a!==null&&this.deletes(a))o="delete",c=pt(a.content.getContent());else return;else a!==null&&this.deletes(a)?(o="update",c=pt(a.content.getContent())):(o="add",c=void 0)}else if(this.deletes(i))o="delete",c=pt(i.content.getContent());else return;t.set(s,{action:o,oldValue:c})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw $e(vs);const n=this.target,r=O(),s=O(),i=[];if(t={added:r,deleted:s,delta:i,keys:this.keys},this.transaction.changed.get(n).has(null)){let c=null;const a=()=>{c&&i.push(c)};for(let h=n._start;h!==null;h=h.right)h.deleted?this.deletes(h)&&!this.adds(h)&&((c===null||c.delete===void 0)&&(a(),c={delete:0}),c.delete+=h.length,s.add(h)):this.adds(h)?((c===null||c.insert===void 0)&&(a(),c={insert:[]}),c.insert=c.insert.concat(h.content.getContent()),r.add(h)):((c===null||c.retain===void 0)&&(a(),c={retain:0}),c.retain+=h.length);c!==null&&c.retain===void 0&&a()}this._changes=t}return t}}const Ao=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,s=t._item.parent._start;for(;s!==t._item&&s!==null;)s.deleted||r++,s=s.right;n.unshift(r)}t=t._item.parent}return n},Ds=80;let ur=0;class xo{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=ur++}}const Oo=e=>{e.timestamp=ur++},Is=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=ur++},Uo=(e,t,n)=>{if(e.length>=Ds){const r=e.reduce((s,i)=>s.timestamp<i.timestamp?s:i);return Is(r,t,n),r}else{const r=new xo(t,n);return e.push(r),r}},Mn=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((i,o)=>qt(t-i.index)<qt(t-o.index)?i:o);let r=e._start,s=0;for(n!==null&&(r=n.p,s=n.index,Oo(n));r.right!==null&&s<t;){if(!r.deleted&&r.countable){if(t<s+r.length)break;s+=r.length}r=r.right}for(;r.left!==null&&s>t;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return n!==null&&qt(n.index-s)<r.parent.length/Ds?(Is(n,r,s),n):Uo(e._searchMarker,r,s)},un=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const s=e[r];if(n>0){let i=s.p;for(i.marker=!1;i&&(i.deleted||!i.countable);)i=i.left,i&&!i.deleted&&i.countable&&(s.index-=i.length);if(i===null||i.marker===!0){e.splice(r,1);continue}s.p=i,i.marker=!0}(t<s.index||n>0&&t===s.index)&&(s.index=x(t,s.index+n))}},mu=e=>{let t=e._start;const n=[];for(;t;)n.push(t),t=t.right;return n},Nn=(e,t,n)=>{const r=e,s=t.changedParentTypes;for(;S(s,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;is(r._eH,n,t)};class bt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=ns(),this._dEH=ns(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw se()}clone(){throw se()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){rs(this._eH,t)}observeDeep(t){rs(this._dEH,t)}unobserve(t){ss(this._eH,t)}unobserveDeep(t){ss(this._dEH,t)}toJSON(){}}const Ts=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const s=[];let i=e._start;for(;i!==null&&r>0;){if(i.countable&&!i.deleted){const o=i.content.getContent();if(o.length<=t)t-=o.length;else{for(let c=t;c<o.length&&r>0;c++)s.push(o[c]),r--;t=0}}i=i.right}return s},As=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let s=0;s<r.length;s++)t.push(r[s])}n=n.right}return t},yu=(e,t)=>{const n=[];let r=e._start;for(;r!==null;){if(r.countable&&_e(r,t)){const s=r.content.getContent();for(let i=0;i<s.length;i++)n.push(s[i])}r=r.right}return n},dn=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const s=r.content.getContent();for(let i=0;i<s.length;i++)t(s[i],n++,e)}r=r.right}},xs=(e,t)=>{const n=[];return dn(e,(r,s)=>{n.push(t(r,s,e))}),n},Mo=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const s=n[r++];return n.length<=r&&(n=null),{done:!1,value:s}}}},Os=(e,t)=>{const n=Mn(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Bn=(e,t,n,r)=>{let s=n;const i=e.doc,o=i.clientID,c=i.store,a=n===null?t._start:n.right;let h=[];const u=()=>{h.length>0&&(s=new q(N(o,ht(c,o)),s,s&&s.lastId,a,a&&a.id,t,null,new ve(h)),s.integrate(e,0),h=[])};r.forEach(g=>{if(g===null)h.push(g);else switch(g.constructor){case Number:case Object:case Boolean:case Array:case String:h.push(g);break;default:switch(u(),g.constructor){case Uint8Array:case ArrayBuffer:s=new q(N(o,ht(c,o)),s,s&&s.lastId,a,a&&a.id,t,null,new en(new Uint8Array(g))),s.integrate(e,0);break;case Re:s=new q(N(o,ht(c,o)),s,s&&s.lastId,a,a&&a.id,t,null,new rn(g)),s.integrate(e,0);break;default:if(g instanceof bt)s=new q(N(o,ht(c,o)),s,s&&s.lastId,a,a&&a.id,t,null,new Xt(g)),s.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Us=()=>$e("Length exceeded!"),Ms=(e,t,n,r)=>{if(n>t._length)throw Us();if(n===0)return t._searchMarker&&un(t._searchMarker,n,r.length),Bn(e,t,null,r);const s=n,i=Mn(t,n);let o=t._start;for(i!==null&&(o=i.p,n-=i.index,n===0&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&It(e,N(o.id.client,o.id.clock+n));break}n-=o.length}return t._searchMarker&&un(t._searchMarker,s,r.length),Bn(e,t,o,r)},No=(e,t,n)=>{let s=(t._searchMarker||[]).reduce((i,o)=>o.index>i.index?o:i,{index:0,p:t._start}).p;if(s)for(;s.right;)s=s.right;return Bn(e,t,s,n)},Ns=(e,t,n,r)=>{if(r===0)return;const s=n,i=r,o=Mn(t,n);let c=t._start;for(o!==null&&(c=o.p,n-=o.index);c!==null&&n>0;c=c.right)!c.deleted&&c.countable&&(n<c.length&&It(e,N(c.id.client,c.id.clock+n)),n-=c.length);for(;r>0&&c!==null;)c.deleted||(r<c.length&&It(e,N(c.id.client,c.id.clock+r)),c.delete(e),r-=c.length),c=c.right;if(r>0)throw Us();t._searchMarker&&un(t._searchMarker,s,-i+r)},Rn=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},dr=(e,t,n,r)=>{const s=t._map.get(n)||null,i=e.doc,o=i.clientID;let c;if(r==null)c=new ve([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c=new ve([r]);break;case Uint8Array:c=new en(r);break;case Re:c=new rn(r);break;default:if(r instanceof bt)c=new Xt(r);else throw new Error("Unexpected content type")}new q(N(o,ht(i.store,o)),s,s&&s.lastId,null,null,t,n,c).integrate(e,0)},hr=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},Bs=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},Rs=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},wu=(e,t,n)=>{let r=e._map.get(t)||null;for(;r!==null&&(!n.sv.has(r.id.client)||r.id.clock>=(n.sv.get(r.id.client)||0));)r=r.left;return r!==null&&_e(r,n)?r.content.getContent()[r.length-1]:void 0},Bo=(e,t)=>{const n={};return e._map.forEach((r,s)=>{let i=r;for(;i!==null&&(!t.sv.has(i.id.client)||i.id.clock>=(t.sv.get(i.id.client)||0));)i=i.left;i!==null&&_e(i,t)&&(n[s]=i.content.getContent()[i.length-1])}),n},Ln=e=>$i(e.entries(),t=>!t[1].deleted);class Ro extends Un{constructor(t,n){super(t,n),this._transaction=n}}class ke extends bt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new ke;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ke}clone(){const t=new ke;return t.insert(0,this.toArray().map(n=>n instanceof bt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),Nn(this,t,new Ro(this,t))}insert(t,n){this.doc!==null?tt(this.doc,r=>{Ms(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?tt(this.doc,n=>{No(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?tt(this.doc,r=>{Ns(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Os(this,t)}toArray(){return As(this)}slice(t=0,n=this.length){return Ts(this,t,n)}toJSON(){return this.map(t=>t instanceof bt?t.toJSON():t)}map(t){return xs(this,t)}forEach(t){dn(this,t)}[Symbol.iterator](){return Mo(this)}_write(t){t.writeTypeRef(oc)}}const Lo=e=>new ke;class Vo extends Un{constructor(t,n,r){super(t,n),this.keysChanged=r}}class Ve extends bt{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,s)=>{this.set(s,r)}),this._prelimContent=null}_copy(){return new Ve}clone(){const t=new Ve;return this.forEach((n,r)=>{t.set(r,n instanceof bt?n.clone():n)}),t}_callObserver(t,n){Nn(this,t,new Vo(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const s=n.content.getContent()[n.length-1];t[r]=s instanceof bt?s.toJSON():s}}),t}get size(){return[...Ln(this._map)].length}keys(){return Qn(Ln(this._map),t=>t[0])}values(){return Qn(Ln(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return Qn(Ln(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?tt(this.doc,n=>{Rn(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?tt(this.doc,r=>{dr(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return hr(this,t)}has(t){return Rs(this,t)}clear(){this.doc!==null?tt(this.doc,t=>{this.forEach(function(n,r,s){Rn(t,s,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(cc)}}const Po=e=>new Ve,Ee=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&Yi(e,t);class fr{constructor(t,n,r,s){this.left=t,this.right=n,this.index=r,this.currentAttributes=s}forward(){switch(this.right===null&&de(),this.right.content.constructor){case mt:this.right.deleted||Qe(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Ls=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case mt:t.right.deleted||Qe(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&It(e,N(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Vn=(e,t,n)=>{const r=new Map,s=Mn(t,n);if(s){const i=new fr(s.p.left,s.p,s.index,r);return Ls(e,i,n-s.index)}else{const i=new fr(null,t._start,0,r);return Ls(e,i,n)}},Vs=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===mt&&Ee(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const s=e.doc,i=s.clientID;r.forEach((o,c)=>{const a=n.left,h=n.right,u=new q(N(i,ht(s.store,i)),a,a&&a.lastId,h,h&&h.id,t,null,new mt(c,o));u.integrate(e,0),n.right=u,n.forward()})},Qe=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},Ps=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===mt&&Ee(t[e.right.content.key]||null,e.right.content.value)))break;e.forward()}},Fs=(e,t,n,r)=>{const s=e.doc,i=s.clientID,o=new Map;for(const c in r){const a=r[c],h=n.currentAttributes.get(c)||null;if(!Ee(h,a)){o.set(c,h);const{left:u,right:g}=n;n.right=new q(N(i,ht(s.store,i)),u,u&&u.lastId,g,g&&g.id,t,null,new mt(c,a)),n.right.integrate(e,0),n.forward()}}return o},gr=(e,t,n,r,s)=>{n.currentAttributes.forEach((m,y)=>{s[y]===void 0&&(s[y]=null)});const i=e.doc,o=i.clientID;Ps(n,s);const c=Fs(e,t,n,s),a=r.constructor===String?new Yt(r):r instanceof bt?new Xt(r):new Ce(r);let{left:h,right:u,index:g}=n;t._searchMarker&&un(t._searchMarker,n.index,a.getLength()),u=new q(N(o,ht(i.store,o)),h,h&&h.lastId,u,u&&u.id,t,null,a),u.integrate(e,0),n.right=u,n.index=g,n.forward(),Vs(e,t,n,c)},zs=(e,t,n,r,s)=>{const i=e.doc,o=i.clientID;Ps(n,s);const c=Fs(e,t,n,s);t:for(;n.right!==null&&(r>0||c.size>0&&(n.right.deleted||n.right.content.constructor===mt));){if(!n.right.deleted)switch(n.right.content.constructor){case mt:{const{key:a,value:h}=n.right.content,u=s[a];if(u!==void 0){if(Ee(u,h))c.delete(a);else{if(r===0)break t;c.set(a,h)}n.right.delete(e)}else n.currentAttributes.set(a,h);break}default:r<n.right.length&&It(e,N(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let a="";for(;r>0;r--)a+=`
`;n.right=new q(N(o,ht(i.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Yt(a)),n.right.integrate(e,0),n.forward()}Vs(e,t,n,c)},js=(e,t,n,r,s)=>{let i=t;const o=E();for(;i&&(!i.countable||i.deleted);){if(!i.deleted&&i.content.constructor===mt){const h=i.content;o.set(h.key,h)}i=i.right}let c=0,a=!1;for(;t!==i;){if(n===t&&(a=!0),!t.deleted){const h=t.content;switch(h.constructor){case mt:{const{key:u,value:g}=h,m=r.get(u)||null;(o.get(u)!==h||m===g)&&(t.delete(e),c++,!a&&(s.get(u)||null)===g&&m!==g&&(m===null?s.delete(u):s.set(u,m))),!a&&!t.deleted&&Qe(s,h);break}}}t=t.right}return c},Fo=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===mt){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},zo=e=>{let t=0;return tt(e.doc,n=>{let r=e._start,s=e._start,i=E();const o=R(i);for(;s;){if(s.deleted===!1)switch(s.content.constructor){case mt:Qe(o,s.content);break;default:t+=js(n,r,s,i,o),i=R(o),r=s;break}s=s.right}}),t},jo=e=>{const t=new Set,n=e.doc;for(const[r,s]of e.afterState.entries()){const i=e.beforeState.get(r)||0;s!==i&&gs(e,n.store.clients.get(r),i,s,o=>{!o.deleted&&o.content.constructor===mt&&o.constructor!==Bt&&t.add(o.parent)})}tt(n,r=>{Ge(e,e.deleteSet,s=>{if(s instanceof Bt||!s.parent._hasFormatting||t.has(s.parent))return;const i=s.parent;s.content.constructor===mt?t.add(i):Fo(r,s)});for(const s of t)zo(s)})},$s=(e,t,n)=>{const r=n,s=R(t.currentAttributes),i=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Xt:case Ce:case Yt:n<t.right.length&&It(e,N(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}i&&js(e,i,t.right,s,t.currentAttributes);const o=(t.left||t.right).parent;return o._searchMarker&&un(o._searchMarker,t.index,-r+n),t};class $o extends Un{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];tt(t,r=>{const s=new Map,i=new Map;let o=this.target._start,c=null;const a={};let h="",u=0,g=0;const m=()=>{if(c!==null){let y=null;switch(c){case"delete":g>0&&(y={delete:g}),g=0;break;case"insert":(typeof h=="object"||h.length>0)&&(y={insert:h},s.size>0&&(y.attributes={},s.forEach((k,P)=>{k!==null&&(y.attributes[P]=k)}))),h="";break;case"retain":u>0&&(y={retain:u},Wi(a)||(y.attributes=Zi({},a))),u=0;break}y&&n.push(y),c=null}};for(;o!==null;){switch(o.content.constructor){case Xt:case Ce:this.adds(o)?this.deletes(o)||(m(),c="insert",h=o.content.getContent()[0],m()):this.deletes(o)?(c!=="delete"&&(m(),c="delete"),g+=1):o.deleted||(c!=="retain"&&(m(),c="retain"),u+=1);break;case Yt:this.adds(o)?this.deletes(o)||(c!=="insert"&&(m(),c="insert"),h+=o.content.str):this.deletes(o)?(c!=="delete"&&(m(),c="delete"),g+=o.length):o.deleted||(c!=="retain"&&(m(),c="retain"),u+=o.length);break;case mt:{const{key:y,value:k}=o.content;if(this.adds(o)){if(!this.deletes(o)){const P=s.get(y)||null;Ee(P,k)?k!==null&&o.delete(r):(c==="retain"&&m(),Ee(k,i.get(y)||null)?delete a[y]:a[y]=k)}}else if(this.deletes(o)){i.set(y,k);const P=s.get(y)||null;Ee(P,k)||(c==="retain"&&m(),a[y]=P)}else if(!o.deleted){i.set(y,k);const P=a[y];P!==void 0&&(Ee(P,k)?P!==null&&o.delete(r):(c==="retain"&&m(),k===null?delete a[y]:a[y]=k))}o.deleted||(c==="insert"&&m(),Qe(s,o.content));break}}o=o.right}for(m();n.length>0;){const y=n[n.length-1];if(y.retain!==void 0&&y.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class qe extends bt{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new qe}clone(){const t=new qe;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new $o(this,t,n);Nn(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Yt&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?tt(this.doc,r=>{const s=new fr(null,this._start,0,new Map);for(let i=0;i<t.length;i++){const o=t[i];if(o.insert!==void 0){const c=!n&&typeof o.insert=="string"&&i===t.length-1&&s.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof c!="string"||c.length>0)&&gr(r,this,s,c,o.attributes||{})}else o.retain!==void 0?zs(r,this,s,o.retain,o.attributes||{}):o.delete!==void 0&&$s(r,s,o.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const s=[],i=new Map,o=this.doc;let c="",a=this._start;function h(){if(c.length>0){const g={};let m=!1;i.forEach((k,P)=>{m=!0,g[P]=k});const y={insert:c};m&&(y.attributes=g),s.push(y),c=""}}const u=()=>{for(;a!==null;){if(_e(a,t)||n!==void 0&&_e(a,n))switch(a.content.constructor){case Yt:{const g=i.get("ychange");t!==void 0&&!_e(a,t)?(g===void 0||g.user!==a.id.client||g.type!=="removed")&&(h(),i.set("ychange",r?r("removed",a.id):{type:"removed"})):n!==void 0&&!_e(a,n)?(g===void 0||g.user!==a.id.client||g.type!=="added")&&(h(),i.set("ychange",r?r("added",a.id):{type:"added"})):g!==void 0&&(h(),i.delete("ychange")),c+=a.content.str;break}case Xt:case Ce:{h();const g={insert:a.content.getContent()[0]};if(i.size>0){const m={};g.attributes=m,i.forEach((y,k)=>{m[k]=y})}s.push(g);break}case mt:_e(a,t)&&(h(),Qe(i,a.content));break}a=a.right}h()};return t||n?tt(o,g=>{t&&or(g,t),n&&or(g,n),u()},"cleanup"):u(),s}insert(t,n,r){if(n.length<=0)return;const s=this.doc;s!==null?tt(s,i=>{const o=Vn(i,this,t);r||(r={},o.currentAttributes.forEach((c,a)=>{r[a]=c})),gr(i,this,o,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r={}){const s=this.doc;s!==null?tt(s,i=>{const o=Vn(i,this,t);gr(i,this,o,n,r)}):this._pending.push(()=>this.insertEmbed(t,n,r))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?tt(r,s=>{$s(s,Vn(s,this,t),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const s=this.doc;s!==null?tt(s,i=>{const o=Vn(i,this,t);o.right!==null&&zs(i,this,o,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{Rn(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?tt(this.doc,r=>{dr(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return hr(this,t)}getAttributes(){return Bs(this)}_write(t){t.writeTypeRef(lc)}}const Zo=e=>new qe;class pr{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===tn||n.constructor===Pe)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Pe extends bt{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Pe}clone(){const t=new Pe;return t.insert(0,this.toArray().map(n=>n instanceof bt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new pr(this,t)}querySelector(t){t=t.toUpperCase();const r=new pr(this,s=>s.nodeName&&s.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),at(new pr(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){Nn(this,t,new Wo(this,n,t))}toString(){return xs(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const s=t.createDocumentFragment();return r!==void 0&&r._createAssociation(s,this),dn(this,i=>{s.insertBefore(i.toDOM(t,n,r),null)}),s}insert(t,n){this.doc!==null?tt(this.doc,r=>{Ms(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)tt(this.doc,r=>{const s=t&&t instanceof bt?t._item:t;Bn(r,this,s,n)});else{const r=this._prelimContent,s=t===null?0:r.findIndex(i=>i===t)+1;if(s===0&&t!==null)throw $e("Reference item not found");r.splice(s,0,...n)}}delete(t,n=1){this.doc!==null?tt(this.doc,r=>{Ns(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return As(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Os(this,t)}slice(t=0,n=this.length){return Ts(this,t,n)}forEach(t){dn(this,t)}_write(t){t.writeTypeRef(uc)}}const Ho=e=>new Pe;class tn extends Pe{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,s)=>{this.setAttribute(s,r)}),this._prelimAttrs=null}_copy(){return new tn(this.nodeName)}clone(){const t=new tn(this.nodeName),n=this.getAttributes();return Gi(n,(r,s)=>{typeof r=="string"&&t.setAttribute(s,r)}),t.insert(0,this.toArray().map(r=>r instanceof bt?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const c in t)r.push(c);r.sort();const s=r.length;for(let c=0;c<s;c++){const a=r[c];n.push(a+'="'+t[a]+'"')}const i=this.nodeName.toLocaleLowerCase(),o=n.length>0?" "+n.join(" "):"";return`<${i}${o}>${super.toString()}</${i}>`}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{Rn(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?tt(this.doc,r=>{dr(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return hr(this,t)}hasAttribute(t){return Rs(this,t)}getAttributes(t){return t?Bo(this,t):Bs(this)}toDOM(t=document,n={},r){const s=t.createElement(this.nodeName),i=this.getAttributes();for(const o in i){const c=i[o];typeof c=="string"&&s.setAttribute(o,c)}return dn(this,o=>{s.appendChild(o.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(ac),t.writeKey(this.nodeName)}}const Go=e=>new tn(e.readKey());class Wo extends Un{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class hn extends Ve{constructor(t){super(),this.hookName=t}_copy(){return new hn(this.hookName)}clone(){const t=new hn(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const s=n[this.hookName];let i;return s!==void 0?i=s.createDom(this):i=document.createElement(this.hookName),i.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(dc),t.writeKey(this.hookName)}}const Jo=e=>new hn(e.readKey());class Pn extends qe{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Pn}clone(){const t=new Pn;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const s=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(s,this),s}toString(){return this.toDelta().map(t=>{const n=[];for(const s in t.attributes){const i=[];for(const o in t.attributes[s])i.push({key:o,value:t.attributes[s][o]});i.sort((o,c)=>o.key<c.key?-1:1),n.push({nodeName:s,attrs:i})}n.sort((s,i)=>s.nodeName<i.nodeName?-1:1);let r="";for(let s=0;s<n.length;s++){const i=n[s];r+=`<${i.nodeName}`;for(let o=0;o<i.attrs.length;o++){const c=i.attrs[o];r+=` ${c.key}="${c.value}"`}r+=">"}r+=t.insert;for(let s=n.length-1;s>=0;s--)r+=`</${n[s].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(hc)}}const Ko=e=>new Pn;class Zs{constructor(t,n){this.id=t,this.length=n}get deleted(){throw se()}mergeWith(t){return!1}write(t,n,r){throw se()}integrate(t,n){throw se()}}const Yo=0;class Bt extends Zs{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),hs(t.doc.store,this)}write(t,n){t.writeInfo(Yo),t.writeLen(this.length-n)}getMissing(t,n){return null}}class en{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new en(this.content)}splice(t){throw se()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const Xo=e=>new en(e.readBuf());class nn{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new nn(this.len)}splice(t){const n=new nn(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){ln(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const Qo=e=>new nn(e.readLen()),Hs=(e,t)=>new Re(wr(zn({guid:e},t),{shouldLoad:t.shouldLoad||t.autoLoad||!1}));class rn{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new rn(Hs(this.doc.guid,this.opts))}splice(t){throw se()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const qo=e=>new rn(Hs(e.readString(),e.readAny()));class Ce{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Ce(this.embed)}splice(t){throw se()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const tc=e=>new Ce(e.readJSON());class mt{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new mt(this.key,this.value)}splice(t){throw se()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const ec=e=>new mt(e.readKey(),e.readJSON());class fn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new fn(this.arr)}splice(t){const n=new fn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){const i=this.arr[s];t.writeString(i===void 0?"undefined":JSON.stringify(i))}}getRef(){return 2}}const nc=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const s=e.readString();s==="undefined"?n.push(void 0):n.push(JSON.parse(s))}return new fn(n)};class ve{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ve(this.arr)}splice(t){const n=new ve(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){const i=this.arr[s];t.writeAny(i)}}getRef(){return 8}}const rc=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new ve(n)};class Yt{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Yt(this.str)}splice(t){const n=new Yt(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",n.str="\uFFFD"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const sc=e=>new Yt(e.readString()),ic=[Lo,Po,Zo,Go,Ho,Jo,Ko],oc=0,cc=1,lc=2,ac=3,uc=4,dc=5,hc=6;class Xt{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Xt(this.type._copy())}splice(t){throw se()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const fc=e=>new Xt(ic[e.readTypeRef()](e)),mr=(e,t)=>{let n=t,r=0,s;do r>0&&(n=N(n.client,n.clock+r)),s=Tn(e,n),r=n.clock-s.id.clock,n=s.redone;while(n!==null&&s instanceof q);return{item:s,diff:r}},yr=(e,t)=>{for(;e!==null&&e.keep!==t;)e.keep=t,e=e.parent._item},Fn=(e,t,n)=>{const{client:r,clock:s}=t.id,i=new q(N(r,s+n),t,N(r,s+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&i.markDeleted(),t.keep&&(i.keep=!0),t.redone!==null&&(i.redone=N(t.redone.client,t.redone.clock+n)),t.right=i,i.right!==null&&(i.right.left=i),e._mergeStructs.push(i),i.parentSub!==null&&i.right===null&&i.parent._map.set(i.parentSub,i),t.length=n,i},Gs=(e,t)=>Rt(e,n=>We(n.deletions,t)),Ws=(e,t,n,r,s,i)=>{const o=e.doc,c=o.store,a=o.clientID,h=t.redone;if(h!==null)return It(e,h);let u=t.parent._item,g=null,m;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!n.has(u)||Ws(e,u,n,r,s,i)===null))return null;for(;u.redone!==null;)u=It(e,u.redone)}const y=u===null?t.parent:u.content.type;if(t.parentSub===null){for(g=t.left,m=t;g!==null;){let ft=g;for(;ft!==null&&ft.parent._item!==u;)ft=ft.redone===null?null:It(e,ft.redone);if(ft!==null&&ft.parent._item===u){g=ft;break}g=g.left}for(;m!==null;){let ft=m;for(;ft!==null&&ft.parent._item!==u;)ft=ft.redone===null?null:It(e,ft.redone);if(ft!==null&&ft.parent._item===u){m=ft;break}m=m.right}}else if(m=null,t.right&&!s){for(g=t;g!==null&&g.right!==null&&(g.right.redone||We(r,g.right.id)||Gs(i.undoStack,g.right.id)||Gs(i.redoStack,g.right.id));)for(g=g.right;g.redone;)g=It(e,g.redone);if(g&&g.right!==null)return null}else g=y._map.get(t.parentSub)||null;const k=ht(c,a),P=N(a,k),ut=new q(P,g,g&&g.lastId,m,m&&m.id,y,t.parentSub,t.content.copy());return t.redone=P,yr(ut,!0),ut.integrate(e,0),ut};class q extends Zs{constructor(t,n,r,s,i,o,c,a){super(t,a.getLength()),this.origin=r,this.left=n,this.right=s,this.rightOrigin=i,this.parent=o,this.parentSub=c,this.redone=null,this.content=a,this.info=this.content.isCountable()?dt:0}set marker(t){(this.info&Pt)>0!==t&&(this.info^=Pt)}get marker(){return(this.info&Pt)>0}get keep(){return(this.info&Vt)>0}set keep(t){this.keep!==t&&(this.info^=Vt)}get countable(){return(this.info&dt)>0}get deleted(){return(this.info&At)>0}set deleted(t){this.deleted!==t&&(this.info^=At)}markDeleted(){this.info|=At}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ht(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ht(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Ye&&this.id.client!==this.parent.client&&this.parent.clock>=ht(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=fs(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=It(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Bt||this.right&&this.right.constructor===Bt)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===q&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===q&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Ye){const r=Tn(n,this.parent);r.constructor===Bt?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=fs(t,t.doc.store,N(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,s;if(r!==null)s=r.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const i=new Set,o=new Set;for(;s!==null&&s!==this.right;){if(o.add(s),i.add(s),Xe(this.origin,s.origin)){if(s.id.client<this.id.client)r=s,i.clear();else if(Xe(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&o.has(Tn(t.doc.store,s.origin)))i.has(Tn(t.doc.store,s.origin))||(r=s,i.clear());else break;s=s.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),hs(t.doc.store,this),this.content.integrate(t,this),ms(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new Bt(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:N(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Xe(t.origin,this.lastId)&&this.right===t&&Xe(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),ln(t.deleteSet,this.id.client,this.id.clock,this.length),ms(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw de();this.content.gc(t),n?yo(t,this,new Bt(this.id,this.length)):this.content=new nn(this.length)}write(t,n){const r=n>0?N(this.id.client,this.id.clock+n-1):this.origin,s=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&it|(r===null?0:Ot)|(s===null?0:ee)|(i===null?0:Ft);if(t.writeInfo(o),r!==null&&t.writeLeftID(r),s!==null&&t.writeRightID(s),r===null&&s===null){const c=this.parent;if(c._item!==void 0){const a=c._item;if(a===null){const h=ls(c);t.writeParentInfo(!0),t.writeString(h)}else t.writeParentInfo(!1),t.writeLeftID(a.id)}else c.constructor===String?(t.writeParentInfo(!0),t.writeString(c)):c.constructor===Ye?(t.writeParentInfo(!1),t.writeLeftID(c)):de();i!==null&&t.writeString(i)}this.content.write(t,n)}}const Js=(e,t)=>gc[t&binary.BITS5](e),gc=[()=>{de()},Qo,nc,Xo,sc,tc,ec,fc,rc,qo,()=>{de()}],pc=10;class Ut extends null{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){error.unexpectedCase()}write(t,n){t.writeInfo(pc),encoding.writeVarUint(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const Ks=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:{},Ys="__ $YJS$ __";Ks[Ys]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),Ks[Ys]=!0}}]);
}());
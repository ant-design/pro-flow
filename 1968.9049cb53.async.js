"use strict";(self.webpackChunk_ant_design_pro_flow=self.webpackChunk_ant_design_pro_flow||[]).push([[1968],{91229:function(ve,ee,n){n.d(ee,{AC:function(){return Q},iq:function(){return p},oR:function(){return v}});var te=n(67855),F=n.n(te),Y=n(50959),z=n(3656),L=n(13422),R=n(29130),$=n(11527),C=function(K){var M=K.collapsedKeys,d=K.onCollapsedKeysChange;return(0,z.Ue)(function(h,m){return{collapsedKeys:M!=null?M:[],onCollapsedKeysChange:d,toggleCollapsedKey:function(H){var g,V,P=[];m().collapsedKeys.includes(H)?P=m().collapsedKeys.filter(function(I){return I!==H}):P=[].concat(F()(m().collapsedKeys),[H]),h({collapsedKeys:P}),(g=(V=m()).onCollapsedKeysChange)===null||g===void 0||g.call(V,P)}}})},J=(0,L.k)(),v=J.useStore,Q=J.useStoreApi,A=J.Provider,b=(0,Y.memo)(function(T){var K=T.collapsedKeys,M=Q(),d=(0,R.N)(M);return d("collapsedKeys",K),null}),p=(0,Y.memo)(function(T){var K=T.children,M=T.defaultCollapsedKeys,d=T.onCollapsedKeysChange,h=T.collapsedKeys;return(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(A,{createStore:function(){return C({collapsedKeys:M,onCollapsedKeysChange:d})},children:[K,(0,$.jsx)(b,{collapsedKeys:h})]})})})},21968:function(ve,ee,n){n.d(ee,{Z:function(){return ue}});var te=n(77117),F=n.n(te),Y=n(95530),z=n.n(Y),L=n(18840),R=n.n(L),$=n(75693),C=n(39501),J=n(73979),v=n(50959),Q=n(28152),A=n.n(Q),b=n(89947),p=n(74677),T=n(24819),K=n(26633),M=n(82882),d=n(11527),h=["value","onChange","onValueChanging","onChangeEnd"],m=(0,v.memo)(function(i){var E=i.value,N=i.onChange,D=i.onValueChanging,U=i.onChangeEnd,w=z()(i,h),X=E||"",W=(0,v.useState)(X),ce=A()(W,2),k=ce[0],se=ce[1],pe=(0,v.useRef)(null),_=(0,v.useRef)(!1),de=(0,v.useRef)(!1),fe=(0,v.useCallback)(function(){N==null||N(k)},[k]);return(0,v.useEffect)(function(){typeof E!="undefined"&&se(E)},[E]),(0,d.jsx)(M.I,F()(F()({ref:pe},w),{},{value:k,onCompositionStart:function(){_.current=!0},onCompositionEnd:function(){_.current=!1},onFocus:function(){de.current=!0},onBlur:function(){de.current=!1,U==null||U(k)},onChange:function(G){se(G.target.value),D==null||D(G.target.value)},onPressEnter:function(G){!G.shiftKey&&!_.current&&(G.preventDefault(),fe(),de.current=!1,U==null||U(k))},suffix:E===k?(0,d.jsx)("span",{}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(K.ZP,{type:"link",size:"small",onClick:function(){se(E)},style:{padding:0},children:"\u91CD\u7F6E"}),(0,d.jsx)(K.ZP,{type:"link",size:"small",style:{padding:0},onClick:function(){fe()},children:"\u4FDD\u5B58 \u21B5"})]})}))}),O=(0,v.memo)(function(i){var E=i.value,N=i.onChange,D=(0,v.useState)(!1),U=A()(D,2),w=U[0],X=U[1];return w?(0,d.jsx)(m,{onChange:N,onChangeEnd:function(){X(!1)},value:E}):(0,d.jsxs)(T.D,{gap:8,align:"center",horizontal:!0,children:[(0,d.jsx)("span",{style:{lineHeight:1},children:E}),(0,d.jsx)(p.Z,{icon:(0,d.jsx)(b.Z,{}),onClick:function(){X(!w)},placement:"right",title:"Edit"})]})}),H=O,g=n(19683),V=n(91229),P=["id","onTitleChange","onCollapsedKeysChange"],I,ne,ie=(0,J.kc)(function(i){var E=i.css,N=i.token,D=i.prefixCls;return{container:E(I||(I=R()([`
    will-change: transform;
    width: 100%;
    max-width: 600px;
    border: 1px solid `,`;
    border-radius: 12px;
    .`,`-card-head {
      padding-right: 16px;
    }

    .editor-field-item-container:not(:last-child) {
      margin-bottom: 24px;
    }
  `])),N.colorBorder,D),selected:E(ne||(ne=R()([`
    border-color: `,`;
    border-width: 2px;
    box-shadow: 0 9px 25px -6px rgba(0, 0, 0, 0.1);
  `])),N.colorPrimary)}}),x=(0,v.memo)(function(i){var E=i.active,N=i.collapsedKeys,D=i.onCollapsedKeysChange,U=i.onTitleChange,w=i.style,X=i.className,W=i.title,ce=i.children,k=i.extra,se=ie(),pe=se.styles,_=se.cx,de=(0,v.useRef)(null);return(0,d.jsx)($.ZP,{getPopupContainer:function(){return de.current||document.body},children:(0,d.jsx)(V.iq,{collapsedKeys:N,onCollapsedKeysChange:D,children:(0,d.jsx)(C.Z,{ref:de,title:(0,d.jsx)(H,{onChange:U,value:W||"\u57FA\u7840\u8282\u70B9"}),className:_(pe.container,E&&pe.selected,X),extra:k,style:w,children:ce})})})}),ge=(0,v.memo)(function(i){var E=i.id,N=i.onTitleChange,D=i.onCollapsedKeysChange,U=z()(i,P),w=(0,g.d)();return(0,d.jsx)(x,F()({onTitleChange:function(W){w.updateNodeMeta(E,"title",W),N==null||N(W)},onCollapsedKeysChange:function(W){w.updateNodeState(E,"collapsedKeys",W),D==null||D(W)}},U))}),ae=ge;ae.Preview=x;var ue=ae},19683:function(ve,ee,n){n.d(ee,{d:function(){return v}});var te=n(77117),F=n.n(te),Y=n(95530),z=n.n(Y),L=n(80111),R=n(50959),$=n(52445),C=n(70863),J=["yjsDoc","flattenEdges","selectedKeys","onFlattenNodesChange","onEdgesChange","onFlattenEdgesChange","onNodesChange","onViewPortChange","onNodesTreeChange","onSelectionChange","onElementSelectChange","updateEdgesOnEdgeChange","updateEdgesOnConnection","internalUpdateEdges","internalUpdateNodes","internalUpdateSelection"],v=function(){var A=(0,C.AC)(),b=(0,$._K)(),p=A.getState(),T=p.yjsDoc,K=p.flattenEdges,M=p.selectedKeys,d=p.onFlattenNodesChange,h=p.onEdgesChange,m=p.onFlattenEdgesChange,O=p.onNodesChange,H=p.onViewPortChange,g=p.onNodesTreeChange,V=p.onSelectionChange,P=p.onElementSelectChange,I=p.updateEdgesOnEdgeChange,ne=p.updateEdgesOnConnection,ie=p.internalUpdateEdges,x=p.internalUpdateNodes,ge=p.internalUpdateSelection,ae=z()(p,J),ue=(0,L.Z)(function(){return A.getState().flattenNodes}),i=(0,L.Z)(function(){return A.getState().flattenEdges}),E=(0,L.Z)(function(){return A.getState().selectedKeys}),N=(0,R.useCallback)(function(D){return b?b.screenToFlowPosition(D):{x:0,y:0}},[b]);return(0,R.useMemo)(function(){return F()(F()({},ae),{},{screenToFlowPosition:N,getFlattenNodes:ue,getSelectedKeys:E,getFlattenEdges:i})},[ae])}},70863:function(ve,ee,n){n.d(ee,{zt:function(){return xe},ze:function(){return Se},oR:function(){return De},AC:function(){return je}});var te=n(63146),F=n(69971),Y=n(38980),z=n(13422),L=n(28152),R=n.n(L),$=n(90696),C=n.n($),J=n(13762),v=n.n(J),Q=n(41206),A=n.n(Q),b=n(96345),p=n.n(b),T=n(15033),K=n.n(T),M=n(21320),d=n.n(M),h=n(15836),m=p()(function B(l){K()(this,B),d()(this,"type",void 0),d()(this,"name",void 0),d()(this,"timestamp",void 0),this.type=l.type,this.name=l.name,this.timestamp=l.timestamp}),O=function(B){v()(t,B);var l=A()(t);function t(o){var e;return K()(this,t),e=l.call(this,o),d()(C()(e),"_internalHistoryKey","__INTERNAL_HISTORY_MAP__"),d()(C()(e),"undoManager",void 0),d()(C()(e),"updateHistoryData",function(a){var r=e.getMap(e._internalHistoryKey);Object.entries(a).forEach(function(s){var u=R()(s,2),f=u[0],c=u[1];r.set(f,c)})}),d()(C()(e),"recordHistoryData",function(a,r){e.transact(function(){e.updateHistoryData(a)},new m(r))}),d()(C()(e),"getHistoryMap",function(){return e.getMap(e._internalHistoryKey)}),d()(C()(e),"getHistoryJSON",function(){var a=e.getMap(e._internalHistoryKey);return a.toJSON()}),d()(C()(e),"redo",function(){return e.undoManager.redo()}),d()(C()(e),"undo",function(){return e.undoManager.undo()}),e.undoManager=new h.H6(e.getHistoryMap(),{trackedOrigins:new Set([m])}),e}return p()(t)}(h.QW),H=n(77117),g=n.n(H),V={reactflow:{},flattenNodes:{},flattenEdges:{},selectedKeys:[],yjsDoc:new O},P=n(95530),I=n.n(P),ne=n(3341),ie=n.n(ne),x=n(64461),ge="$$",ae="@@",ue=function(l,t){return l+ae+(t||"")},i=function(l,t,o,e){return ue(l,o)+ge+ue(t,e)},E=function(l){var t=l.split(ge),o=_slicedToArray(t,2),e=o[0],a=o[1];if(!e||!a)return{source:"",target:"",sourceHandle:"",targetHandle:""};var r=e.split(ae),s=_slicedToArray(r,2),u=s[0],f=s[1],c=a.split(ae),y=_slicedToArray(c,2),j=y[0],q=y[1];return{source:u,target:j,sourceHandle:f,targetHandle:q}},N=function(l,t){switch(t.type){case"addEdge":return(0,x.Uy)(l,function(o){o[t.edge.id]=t.edge});case"addEdges":return(0,x.Uy)(l,function(o){var e=t.edges;e&&Object.keys(e).forEach(function(a){o[a]||(o[a]=e[a])})});case"updateEdge":return(0,x.Uy)(l,function(o){var e=t.id,a=t.edge;o[e]=g()(g()({},o[e]),a)});case"deleteEdge":return(0,x.Uy)(l,function(o){delete o[t.id]});case"createEdgeFromConnection":return(0,x.Uy)(l,function(o){var e=t.connection,a=e.source,r=e.target,s=e.sourceHandle,u=e.targetHandle;if(!(!a||!r)){var f=i(a,r,s,u);o[f]={id:f,source:a,target:r,sourceHandle:s,targetHandle:u}}});default:return l}},D=["type"],U=function(l,t){return{internalUpdateEdges:function(e,a){var r,s;l({flattenEdges:e},!1,a),(r=(s=t()).onFlattenEdgesChange)===null||r===void 0||r.call(s,e)},dispatchEdges:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{recordHistory:!0},r=a.recordHistory,s=r===void 0?!0:r,u=e.type,f=I()(e,D),c=N(t().flattenEdges,e);if(!ie()(c,t().flattenEdges)){var y=t(),j=y.internalUpdateEdges,q=y.yjsDoc;j(c,{type:"dispatchFlattenEdges/".concat(u),payload:f}),s&&q.recordHistoryData({flattenEdges:c},{type:"edge",name:e.type,timestamp:Date.now()})}},addEdges:function(e,a){t().dispatchEdges({type:"addEdges",edges:e},a)},updateEdgesOnConnection:function(e){t().dispatchEdges({type:"createEdgeFromConnection",connection:e})},updateEdgesOnEdgeChange:function(e){e.forEach(function(a){switch(a.type){case"remove":t().dispatchEdges({type:"deleteEdge",id:a.id})}})}}},w=n(62071),X=function(l,t){switch(t.type){case"addNode":return(0,x.Uy)(l,function(o){!t.node||!t.node.id||(o[t.node.id]=t.node)});case"addNodes":return(0,x.Uy)(l,function(o){var e=t.nodes;e&&Object.keys(e).forEach(function(a){o[a]||(o[a]=e[a])})});case"deleteNode":return(0,x.Uy)(l,function(o){delete o[t.id]});case"updateNodePosition":return(0,x.Uy)(l,function(o){o[t.id]&&t.position&&(o[t.id].position=t.position)});case"updateNodeMeta":return(0,x.Uy)(l,function(o){if(o[t.id]){var e=o[t.id];e.data.meta[t.key]=t.value}});case"updateNodeState":return(0,x.Uy)(l,function(o){if(o[t.id]){var e=o[t.id];e.data.state[t.key]=t.value}});case"updateNodeContent":return(0,x.Uy)(l,function(o){var e=t.key,a=t.id,r=t.value;if(o[a]){var s=o[a];s.data.content?s.data.content[e]=r:s.data.content=d()({},e,r)}});case"updateNodeData":return(0,x.Uy)(l,function(o){var e=t.newData,a=t.id,r=t.deepReplace;if(o[a]){var s=o[a];r?s.data=g()(g()({},s.data),e):(0,w.Z)(s.data,e)}});default:return l}},W=["type"],ce=function(l,t){return{internalUpdateNodes:function(e,a){var r,s;ie()(e,t().flattenNodes)||(l({flattenNodes:e},!1,a),(r=(s=t()).onFlattenNodesChange)===null||r===void 0||r.call(s,e))},dispatchNodes:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{recordHistory:!0},r=a.recordHistory,s=r===void 0?!0:r,u=e.type,f=I()(e,W),c=X(t().flattenNodes,e);if(!ie()(c,t().flattenNodes)){t().internalUpdateNodes(c,{type:"dispatchFlattenNodes/".concat(u),payload:f});var y=t(),j=y.yjsDoc;s&&j.recordHistoryData({flattenNodes:c},{type:"nodes",name:e.type,timestamp:Date.now()})}},updateNodeMeta:function(e,a,r,s){t().dispatchNodes({type:"updateNodeMeta",id:e,key:a,value:r},s)},updateNodeState:function(e,a,r,s){t().dispatchNodes({type:"updateNodeState",id:e,key:a,value:r},s)},updateNodeContent:function(e,a,r,s){t().dispatchNodes({type:"updateNodeContent",id:e,key:a,value:r},s)},updateNodeData:function(e,a){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3?arguments[3]:void 0;t().dispatchNodes({type:"updateNodeData",id:e,newData:a,deepReplace:r},s)},addNode:function(e){t().dispatchNodes({type:"addNode",node:e})},addNodes:function(e,a){t().dispatchNodes({type:"addNodes",nodes:e},a)},deleteNode:function(e){t().deselectElement(e),t().dispatchNodes({type:"deleteNode",id:e})}}},k=n(38887),se=n.n(k),pe=n(13448),_=n.n(pe),de=n(74815),fe=n.n(de),oe=n(67855),G=n.n(oe),Ee=n(67197),me=(0,Ee.kP)("0123456789abcdefghijklmnopqrstuvwxyz",16),Ce=function(l,t){return{internalUpdateSelection:function(e,a){var r,s;l({selectedKeys:e},!1,a),(r=(s=t()).onSelectionChange)===null||r===void 0||r.call(s,e)},onElementSelectChange:function(e,a){a?t().selectElement(e):t().deselectElement(e)},actionList:function(){var e=t(),a=e.yjsDoc;return{undo:a.undoManager.undoStack.length,redo:a.undoManager.redoStack.length}},selectElement:function(e){t().selectedKeys.includes(e)||t().internalUpdateSelection([].concat(G()(t().selectedKeys),[e]),{type:"selection/selectElement",payload:{id:e}})},selectElements:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t().internalUpdateSelection(a?[].concat(G()(t().selectedKeys),G()(e)):e,{type:"selection/selectElements",payload:{ids:e}})},selectAll:function(){var e=t().reactflow.getNodes(),a=t().reactflow.getEdges(),r=[].concat(G()(e.map(function(s){return s.id})),G()(a.map(function(s){return s.id})));t().internalUpdateSelection(r,{type:"selection/selectAll",payload:{ids:r}})},deselectElement:function(e){t().internalUpdateSelection(t().selectedKeys.filter(function(a){return a!==e}),{type:"selection/deselectElement",payload:{id:e}})},deselectAll:function(){t().internalUpdateSelection([],{type:"selection/deselectAll",payload:{}})},deleteSelection:function(){var e=t(),a=e.selectedKeys,r=e.flattenEdges,s=e.flattenNodes,u=e.dispatchNodes,f=e.dispatchEdges;a.forEach(function(c){s[c]&&u({type:"deleteNode",id:c}),r[c]&&f({type:"deleteEdge",id:c})})},copySelection:function(){var o=fe()(_()().mark(function a(){var r,s,u,f,c,y,j,q,S,Z;return _()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(r=t(),s=r.selectedKeys,u=r.flattenEdges,f=r.flattenNodes,s.length!==0){le.next=3;break}return le.abrupt("return");case 3:return c=Object.values(f).filter(function(he){return s.includes(he.id)}),y=Object.values(u).filter(function(he){return s.includes(he.id)}),j={nodes:c,edges:y},q=new Blob([JSON.stringify(j)],{type:"text/html"}),S=new Blob([JSON.stringify(j)],{type:"text/plain"}),Z=new ClipboardItem({"text/html":q,"text/plain":S}),le.next=11,navigator.clipboard.write([Z]);case 11:return le.abrupt("return",j);case 12:case"end":return le.stop()}},a)}));function e(){return o.apply(this,arguments)}return e}(),paste:function(){var o=fe()(_()().mark(function a(){var r;return _()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,navigator.clipboard.read();case 2:r=u.sent,r.forEach(function(f){var c=se()(f.types),y;try{for(c.s();!(y=c.n()).done;){var j=y.value;if(j==="text/plain"){var q=f.getType(j);q.then(function(S){S.text().then(function(Z){var re=void 0;try{re=JSON.parse(Z)}catch(le){}re&&t().pasteIntoFlow(re)})})}}}catch(S){c.e(S)}finally{c.f()}});case 4:case"end":return u.stop()}},a)}));function e(){return o.apply(this,arguments)}return e}(),pasteIntoFlow:function(e){var a=t(),r=a.yjsDoc,s=a.addEdges,u=a.addNodes,f=a.deselectAll,c=a.selectElements,y={},j={};f(),e.nodes.forEach(function(S){var Z=me();y[Z]=g()(g()({},S),{},{id:Z,position:{x:S.position.x+10,y:S.position.y+10}}),e.edges.forEach(function(re){re.source===S.id&&(re.source=Z),re.target===S.id&&(re.target=Z)})}),e.edges.forEach(function(S){var Z=i(S.source,S.target,S.sourceHandle,S.targetHandle);j[Z]=g()(g()({},S),{},{id:Z})}),u(y,{recordHistory:!1}),s(j,{recordHistory:!1}),r.recordHistoryData({flattenNodes:t().flattenNodes,flattenEdges:t().flattenEdges},{type:"paste",name:"\u7C98\u8D34",timestamp:Date.now()});var q=Object.keys(y).concat(Object.keys(j));c(q)},undo:function(){var e=t(),a=e.yjsDoc,r=e.internalUpdateEdges,s=e.internalUpdateNodes,u=a.undo(),f=a.getHistoryJSON(),c=f.flattenNodes,y=f.flattenEdges;s(c||{},{type:"history/undo",payload:u}),r(y||{},{type:"history/undo",payload:u})},redo:function(){var e=t(),a=e.yjsDoc,r=e.internalUpdateEdges,s=e.internalUpdateNodes,u=a.redo(),f=a.getHistoryJSON(),c=f.flattenNodes,y=f.flattenEdges;s(c,{type:"history/redo",payload:u}),r(y,{type:"history/redo",payload:u})}}},Ne=function(l){return function(){return g()(g()(g()(g()({},V),{},{yjsDoc:l},U.apply(void 0,arguments)),ce.apply(void 0,arguments)),Ce.apply(void 0,arguments))}},Se=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=new O;return(0,F.F)()((0,Y.v)(l)(Ne(t),{name:"FLOW_EDITOR"}),te.X)},ye=(0,z.k)(),xe=ye.Provider,De=ye.useStore,je=ye.useStoreApi},82882:function(ve,ee,n){n.d(ee,{I:function(){return M},K:function(){return d}});var te=n(77117),F=n.n(te),Y=n(95530),z=n.n(Y),L=n(6807),R=n(50959),$=n(18840),C=n.n($),J=n(73979),v,Q,A,b=(0,J.kc)(function(h){var m=h.css,O=h.token;return{input:m(v||(v=C()([`
    position: relative;

    max-width: 100%;
    height: 36px;
    padding: 0 12px;

    transition: background-color 100ms `,`;

    input {
      background: transparent;
    }
  `])),O.motionEaseOut),block:m(Q||(Q=C()([`
    background-color: `,`;
    border: 1px solid transparent;

    &:hover {
      background-color: `,`;
    }
  `])),O.colorFillTertiary,O.colorFillQuaternary),textarea:m(A||(A=C()([`
    position: relative;

    max-width: 100%;
    padding: 8px 12px;

    transition: background-color 100ms `,`;

    textarea {
      background: transparent;
    }
  `])),O.motionEaseOut)}}),p=n(11527),T=["className","type"],K=["className","type"],M=(0,R.forwardRef)(function(h,m){var O=h.className,H=h.type,g=H===void 0?"ghost":H,V=z()(h,T),P=b(),I=P.styles,ne=P.cx;return(0,p.jsx)(L.Z,F()({className:ne(I.input,g==="block"&&I.block,O),ref:m},V))}),d=(0,R.memo)((0,R.forwardRef)(function(h,m){var O=h.className,H=h.type,g=H===void 0?"ghost":H,V=z()(h,K),P=b(),I=P.styles,ne=P.cx;return(0,p.jsx)(L.Z.TextArea,F()({className:ne(I.textarea,g==="block"&&I.block,O),ref:m},V))}))}}]);
